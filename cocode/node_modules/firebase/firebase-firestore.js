!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(oy){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l,e=t(oy),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ie=l=l||{})[Ie.DEBUG=0]="DEBUG",Ie[Ie.VERBOSE=1]="VERBOSE",Ie[Ie.INFO=2]="INFO",Ie[Ie.WARN=3]="WARN",Ie[Ie.ERROR=4]="ERROR",Ie[Ie.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ee={})[l.DEBUG]="log",Ee[l.VERBOSE]="log",Ee[l.INFO]="info",Ee[l.WARN]="warn",Ee[l.ERROR]="error",Ee),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e,n){e=d.call(this,e)||this;return e.code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},D=N||self;function x(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),R=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++R))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}t:{var J=D.navigator;if(J){J=J.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=x;var rt,it=Y(W,"Opera"),ot=Y(W,"Trident")||Y(W,"MSIE"),st=Y(W,"Edge"),ut=st||ot,at=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),ct=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ht(){var t=D.document;return t?t.documentMode:void 0}t:{var ft="",lt=(lt=W,at?/rv:([^\);]+)(\)|;)/.exec(lt):st?/Edge\/([\d\.]+)/.exec(lt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):ct?/WebKit\/(\S+)/.exec(lt):it?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){lt=ht();if(null!=lt&&lt>parseFloat(ft)){rt=String(lt);break t}}rt=ft}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=D.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",x,e),D.removeEventListener("test",x,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var It={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Ot={};function kt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=jt(r);return e&&e[Et]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Et]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Mt(t);if(c||(t[xt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(St(n,t),0==n.b&&(n.src=null,e[xt]=null)):At(t)))}function Rt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Vt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new bt(e,this))}function Mt(t){return(t=t[xt])instanceof Nt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==O(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function qt(){F.call(this),this.c=new Nt(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[Et]=!0,(A=qt.prototype).addEventListener=function(t,e,n,r){kt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=jt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=D.JSON.stringify;function Bt(){this.b=this.a=null}var zt,Ht=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Wt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Xt(t,e){var n;zt||(n=D.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Yt||(zt(),Yt=!0),Qt.add(t,e)}Bt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new Bt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=Ht;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function $t(t,e){qt.call(this),this.b=t||1,this.a=e||D,this.f=M(this.Ya,this),this.g=j()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==O(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}q($t,qt),(A=$t.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=j()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=j())},A.G=function(){$t.S.G.call(this),Zt(this),delete this.a};var ee,ne,re,ie=(_(ne=se,re=ee=F),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){F.call(this),this.b=t,this.a={}}q(ue,F);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=kt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function fe(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fe.prototype.info=function(){};var pe=null;function de(){return pe=pe||new qt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}q(ye,wt),q(ge,wt),q(we,wt);var Ie={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}_e.prototype.a=null;var Ne,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function xe(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=ke,t=ut?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(Se,wt),q(De,wt),q(xe,_e),Ne=new xe;var ke=45e3,Pe={},Le={};function Re(t,e,n){t.H=1,t.i=en(Ye(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=j(),Me(t),t.l=Ye(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(M(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,me(14),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,me(15),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),qe(t))}function Me(t){t.U=j()+t.P,Ue(t,t.P)}function Ue(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(M(t.Ua,t),e)}function je(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||rr(t.g,t)}function Fe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Hn(u)}Zn(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(M(u.Ra,u),6e3));if(In(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(_n(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=j()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):$n(n),0<u.g.length&&Xn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ve(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ke(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ke(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Oe.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),je(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),Fe(this),qe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Fe(this),qe(this)}}}catch(t){}var u,a,c,h,f,l},A.Va=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ce(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.A=!0,Fe(this)},A.Ua=function(){this.o=null;var t,e,n=j();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),Fe(this),this.h=2,qe(this)):Ue(this,this.U-n)},(A=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return He(this),this.a.concat()},A.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},A.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ye(t){return new Xe(t)}function Qe(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){ln(t),e=vn(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),Ke(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),H(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function In(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function _n(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Sn(){this.a=new Nn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var xn=D.JSON.parse;function On(t){qt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=kn,this.D=this.F=!1}q(On,qt);var kn="",Pn=/^https?$/i,Ln=["POST","PUT"];function Rn(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Un(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.X()))if(t.l&&4==qn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){jn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new fe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Ma=Gn("retryDelaySeedMs",1e4,t),this.Ja=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function zn(t){var e,n;Kn(t),3==t.v&&(e=t.R++,tn(n=Ye(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Qn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Ye(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=j(),Me(e)),sr(t)}function Hn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Kn(t){Hn(t),t.j&&(D.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Xn(t)}function Xn(t){bn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),_n(t.b,n),Re(n,r,e)}function Qn(t,n){t.f&&Be({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Be(t,function(t,e){var n=t;P(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(M(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Qn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ye(e)),n.j=null,n.I=!0,Ve(n,t)}function nr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Xn(t)):$n(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(In(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(M(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Xa,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Qe(r,"https"),en(r)),n=r.toString(),r=o,o=new fe,D.Image?((i=new Image).onload=U(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Dn,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Kn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ye(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),$e(a,a.h)):(u=D.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Qe(u,r),i&&Je(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Qn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function cr(){}function hr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function fr(t,e){qt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function lr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(A=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Rn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=G(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Un(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),On.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ta())},A.Ta=function(){Mn(this)},A.X=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Ye(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Fn(i,this.i,r),_n(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Re(n,i,null)):Re(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||bn(this.b)||Yn(this))},A.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(M(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Hn(this),er(this))},A.Ra=function(){null!=this.m&&(this.m=null,Hn(this),Zn(this),me(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(A=cr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},hr.prototype.a=function(t,e){return new fr(t,e)},q(fr,qt),(A=fr.prototype).addEventListener=function(t,e,n,r){fr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){fr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Xn(t)},A.close=function(){zn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Gt(t),Wn(this.a,e)):Wn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,fr.S.G.call(this)},q(lr,Se),q(pr,De),q(dr,cr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,fr.prototype.send=fr.prototype.Pa,fr.prototype.open=fr.prototype.Oa,Ie.NO_ERROR=0,Ie.TIMEOUT=8,Ie.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",qt.prototype.listen=qt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var yr=Ie,vr=Ee,gr=Ae,mr=On,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Ar,Ir=Error),Ar),Tr=new h("@firebase/firestore");function Ar(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Nr(){return Tr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.DEBUG&&(e=n.map(Or),Tr.debug.apply(Tr,i(["Firestore (8.0.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.ERROR&&(e=n.map(Or),Tr.error.apply(Tr,i(["Firestore (8.0.0): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Tr.logLevel<=l.WARN&&(e=n.map(Or),Tr.warn.apply(Tr,i(["Firestore (8.0.0): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE (8.0.0) INTERNAL ASSERTION FAILED: "+t;throw Dr(t),new Error(t)}function Pr(t){t||kr()}var Lr=(Rr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Rr);function Rr(){}function Vr(t,e){return t<e?-1:e<t?1:0}function Cr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Mr(t){return t+"\0"}var Ur=(jr.fromBase64String=function(t){return new jr(atob(t))},jr.fromUint8Array=function(t){return new jr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},jr.prototype.toBase64=function(){return t=this.i,btoa(t);var t},jr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.i)},jr.prototype.o=function(){return 2*this.i.length},jr.prototype.h=function(t){return Vr(this.i,t.i)},jr.prototype.isEqual=function(t){return this.i===t.i},jr);function jr(t){this.i=t}Ur.u=new Ur("");var qr=(Fr.fromBase64String=function(t){try{return new Fr(Ur.fromBase64String(t))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Fr.fromUint8Array=function(t){return new Fr(Ur.fromUint8Array(t))},Fr.prototype.toBase64=function(){return this.l.toBase64()},Fr.prototype.toUint8Array=function(){return this.l.toUint8Array()},Fr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Fr.prototype.isEqual=function(t){return this.l.isEqual(t.l)},Fr);function Fr(t){this.l=t}function Gr(){if("undefined"==typeof Uint8Array)throw new _r(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Br(){if("undefined"==typeof atob)throw new _r(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function zr(t,e,n,r,i,o){this._=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.T=o}var Hr,Kr=(n(Yr,Hr=qr),Yr.fromBase64String=function(t){Br();try{return new Yr(Ur.fromBase64String(t))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Yr.fromUint8Array=function(t){return Gr(),new Yr(Ur.fromUint8Array(t))},Yr.prototype.toBase64=function(){return Br(),Hr.prototype.toBase64.call(this)},Yr.prototype.toUint8Array=function(){return Gr(),Hr.prototype.toUint8Array.call(this)},Yr.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Yr),Wr=(Object.defineProperty(Xr.prototype,"I",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Xr.prototype.isEqual=function(t){return t instanceof Xr&&t.projectId===this.projectId&&t.database===this.database},Xr.prototype.h=function(t){return Vr(this.projectId,t.projectId)||Vr(this.database,t.database)},Xr);function Xr(t,e){this.projectId=t,this.database=e||"(default)"}function Yr(){return null!==Hr&&Hr.apply(this,arguments)||this}function Qr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $r(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Zr,ti,ei=(di.prototype.get=function(t){var e=this.m(t),e=this.R[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.A(o,t))return i}},di.prototype.has=function(t){return void 0!==this.get(t)},di.prototype.set=function(t,e){var n=this.m(t),r=this.R[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.A(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.R[n]=[[t,e]]},di.prototype.delete=function(t){var e=this.m(t),n=this.R[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.A(n[r][0],t))return 1===n.length?delete this.R[e]:n.splice(r,1),!0;return!1},di.prototype.forEach=function(s){Jr(this.R,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},di.prototype.P=function(){return $r(this.R)},di),ni=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.g=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ri=(li.V=function(t){return new li(t)},li.min=function(){return new li(new ni(0,0))},li.prototype.h=function(t){return this.timestamp.g(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.p=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.v=function(){return this.timestamp},li),Ie=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.S},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.D(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.C(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.N=function(t){return t=void 0===t?1:t,this.C(this.segments,this.offset+t,this.length-t)},fi.prototype.F=function(){return this.C(this.segments,this.offset,this.length-1)},fi.prototype.k=function(){return this.segments[this.offset]},fi.prototype.O=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype.P=function(){return 0===this.length},fi.prototype.M=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.$=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.L=function(){return this.segments.slice(this.offset,this.limit())},fi.D=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),ii=(n(hi,ti=Ie),hi.prototype.C=function(t,e,n){return new hi(t,e,n)},hi.prototype.B=function(){return this.L().join("/")},hi.prototype.toString=function(){return this.B()},hi.q=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new _r(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.U=function(){return new hi([])},hi),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(n(ci,Zr=Ie),ci.prototype.C=function(t,e,n){return new ci(t,e,n)},ci.K=function(t){return oi.test(t)},ci.prototype.B=function(){return this.L().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ci.K(t)||(t="`"+t+"`"),t}).join(".")},ci.prototype.toString=function(){return this.B()},ci.prototype.W=function(){return 1===this.length&&"__name__"===this.get(0)},ci.j=function(){return new ci(["__name__"])},ci.G=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.U=function(){return new ci([])},ci),ui=(ai.H=function(t){return new ai(ii.q(t))},ai.J=function(t){return new ai(ii.q(t).N(5))},ai.prototype.Y=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.D(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.D=function(t,e){return ii.D(t.path,e.path)},ai.X=function(t){return t.length%2==0},ai.Z=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function ci(){return null!==Zr&&Zr.apply(this,arguments)||this}function hi(){return null!==ti&&ti.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.S=n}function li(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t,e){this.m=t,this.A=e,this.R={}}function yi(t){return null==t}function vi(t){return 0===t&&1/t==-1/0}function gi(t){return"number"==typeof t&&Number.isInteger(t)&&!vi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.tt=null};function wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new mi(t,e,n,r,i,o,s)}function bi(t){var e=t;return null===e.tt&&(t=e.path.B(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.B()+t.op.toString()+bo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.B()+t.dir}).join(","),yi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Zu(e.startAt)),e.endAt&&(t+="|ub:",t+=Zu(e.endAt)),e.tt=t),e.tt}function Ii(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ea(t.startAt,e.startAt)&&ea(t.endAt,e.endAt)}function Ei(t){return ui.X(t.path)&&null===t.collectionGroup&&0===t.filters.length}function _i(t){this.count=t}var Ti,Ai=(Ni.prototype.st=function(t){return new Ni(this.target,this.targetId,this.et,t,this.nt,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ni.prototype.it=function(t,e){return new Ni(this.target,this.targetId,this.et,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ni.prototype.rt=function(t){return new Ni(this.target,this.targetId,this.et,this.sequenceNumber,this.nt,t,this.resumeToken)},Ni);function Ni(t,e,n,r,i,o,s){void 0===i&&(i=ri.min()),void 0===o&&(o=ri.min()),void 0===s&&(s=Ur.u),this.target=t,this.targetId=e,this.et=n,this.sequenceNumber=r,this.nt=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Er.OK:return kr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return kr(),0}}function Di(t){if(void 0===t)return Dr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Ti.OK:return Er.OK;case Ti.CANCELLED:return Er.CANCELLED;case Ti.UNKNOWN:return Er.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Er.INTERNAL;case Ti.UNAVAILABLE:return Er.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Er.NOT_FOUND;case Ti.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Ti.ABORTED:return Er.ABORTED;case Ti.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Ti.DATA_LOSS:return Er.DATA_LOSS;default:return kr()}}(Ee=Ti=Ti||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var xi=(Ri.prototype.ot=function(t,e){return new Ri(this.D,this.root.ot(t,e,this.D).copy(null,null,ki.at,null,null))},Ri.prototype.remove=function(t){return new Ri(this.D,this.root.remove(t,this.D).copy(null,null,ki.at,null,null))},Ri.prototype.get=function(t){for(var e=this.root;!e.P();){var n=this.D(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ri.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.P();){var r=this.D(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ri.prototype.P=function(){return this.root.P()},Object.defineProperty(Ri.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ri.prototype.ht=function(){return this.root.ht()},Ri.prototype.ct=function(){return this.root.ct()},Ri.prototype.ut=function(t){return this.root.ut(t)},Ri.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},Ri.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ri.prototype.lt=function(t){return this.root.lt(t)},Ri.prototype._t=function(){return new Oi(this.root,null,this.D,!1)},Ri.prototype.ft=function(t){return new Oi(this.root,t,this.D,!1)},Ri.prototype.dt=function(){return new Oi(this.root,null,this.D,!0)},Ri.prototype.wt=function(t){return new Oi(this.root,t,this.D,!0)},Ri),Oi=(Li.prototype.It=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.Et)for(t=t.left;!t.P();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.P();)this.Tt.push(t),t=t.left;return e},Li.prototype.At=function(){return 0<this.Tt.length},Li.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Li),ki=(Pi.prototype.copy=function(t,e,n,r,i){return new Pi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Pi.prototype.P=function(){return!1},Pi.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},Pi.prototype.lt=function(t){return this.right.lt(t)||t(this.key,this.value)||this.left.lt(t)},Pi.prototype.min=function(){return this.left.P()?this:this.left.min()},Pi.prototype.ht=function(){return this.min().key},Pi.prototype.ct=function(){return this.right.P()?this.key:this.right.ct()},Pi.prototype.ot=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.ot(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.ot(t,e,n))).Pt()},Pi.prototype.gt=function(){if(this.left.P())return Pi.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.gt(),null)).Pt()},Pi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.P()||r.left.Vt()||r.left.left.Vt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Vt()&&(r=r.bt()),r.right.P()||r.right.Vt()||r.right.left.Vt()||(r=r.vt()),0===e(t,r.key)){if(r.right.P())return Pi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.gt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},Pi.prototype.Vt=function(){return this.color},Pi.prototype.Pt=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.St()),t.left.Vt()&&t.left.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.right.Vt()&&(t=t.Dt()),t},Pi.prototype.yt=function(){var t=this.Dt();return t.right.left.Vt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.bt())).St()).Dt()),t},Pi.prototype.vt=function(){var t=this.Dt();return t.left.left.Vt()&&(t=(t=t.bt()).Dt()),t},Pi.prototype.St=function(){var t=this.copy(null,null,Pi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Pi.prototype.bt=function(){var t=this.copy(null,null,Pi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Pi.prototype.Dt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Pi.prototype.Ct=function(){var t=this.Nt();return Math.pow(2,t)<=this.size+1},Pi.prototype.Nt=function(){if(this.Vt()&&this.left.Vt())throw kr();if(this.right.Vt())throw kr();var t=this.left.Nt();if(t!==this.right.Nt())throw kr();return t+(this.Vt()?0:1)},Pi);function Pi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Pi.RED,this.left=null!=r?r:Pi.EMPTY,this.right=null!=i?i:Pi.EMPTY,this.size=this.left.size+1+this.right.size}function Li(t,e,n,r){this.Et=r,this.Tt=[];for(var i=1;!t.P();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Et?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.Et?t.right:t.left}}function Ri(t,e){this.D=t,this.root=e||ki.EMPTY}function Vi(){this.size=0}ki.EMPTY=null,ki.RED=!0,ki.at=!1,ki.EMPTY=(Object.defineProperty(Vi.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(Vi.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Vi.prototype.copy=function(t,e,n,r,i){return this},Vi.prototype.ot=function(t,e,n){return new ki(t,e)},Vi.prototype.remove=function(t,e){return this},Vi.prototype.P=function(){return!0},Vi.prototype.ut=function(t){return!1},Vi.prototype.lt=function(t){return!1},Vi.prototype.ht=function(){return null},Vi.prototype.ct=function(){return null},Vi.prototype.Vt=function(){return!1},Vi.prototype.Ct=function(){return!0},Vi.prototype.Nt=function(){return 0},new Vi);var Ci=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.ht()},qi.prototype.last=function(){return this.data.ct()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},qi.prototype.xt=function(t,e){for(var n=this.data.ft(t[0]);n.At();){var r=n.It();if(0<=this.D(r.key,t[1]))return;e(r.key)}},qi.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data.ft(e):this.data._t();n.At();)if(!t(n.It().key))return},qi.prototype.kt=function(t){t=this.data.ft(t);return t.At()?t.It().key:null},qi.prototype._t=function(){return new Mi(this.data._t())},qi.prototype.ft=function(t){return new Mi(this.data.ft(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).ot(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype.P=function(){return this.data.P()},qi.prototype.Ot=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data._t(),n=t.data._t();e.At();){var r=e.It().key,i=n.It().key;if(0!==this.D(r,i))return!1}return!0},qi.prototype.L=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.D);return e.data=t,e},qi),Mi=(ji.prototype.It=function(){return this.Mt.It().key},ji.prototype.At=function(){return this.Mt.At()},ji),Ui=new xi(ui.D);function ji(t){this.Mt=t}function qi(t){this.D=t,this.data=new xi(this.D)}var Fi=new xi(ui.D);var Gi=new xi(ui.D),Bi=new Ci(ui.D);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Hi=new Ci(Vr);var Ki=(ao.Bt=function(t){return new ao(t.D)},ao.prototype.has=function(t){return null!=this.$t.get(t)},ao.prototype.get=function(t){return this.$t.get(t)},ao.prototype.first=function(){return this.Lt.ht()},ao.prototype.last=function(){return this.Lt.ct()},ao.prototype.P=function(){return this.Lt.P()},ao.prototype.indexOf=function(t){t=this.$t.get(t);return t?this.Lt.indexOf(t):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.Lt.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.Lt.ut(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.ot(t.key,t),e.Lt.ot(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Lt.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.Lt._t(),n=t.Lt._t();e.At();){var r=e.It().key,i=n.It().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.D=this.D,n.$t=t,n.Lt=e,n},ao),Wi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.ot(e,t):3===t.type&&1!==n.type?this.qt=this.qt.ot(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.ot(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.ot(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.ot(e,{type:2,doc:t.doc}):kr()},uo.prototype.Ut=function(){var n=[];return this.qt.ut(function(t,e){n.push(e)}),n},uo),Xi=(so.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Ki.Bt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.Qt.P()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Eu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Kt.isEqual(t.Kt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Yi=(oo.Xt=function(t,e){var n=new Map;return n.set(t,Qi.Zt(t,e)),new oo(ri.min(),n,Hi,Ui,zi())},oo),Qi=(io.Zt=function(t,e){return new io(Ur.u,e,zi(),zi(),zi())},io),Ji=function(t,e,n,r){this.ie=t,this.removedTargetIds=e,this.key=n,this.re=r},$i=function(t,e){this.targetId=t,this.oe=e},Zi=function(t,e,n,r){void 0===n&&(n=Ur.u),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},to=(Object.defineProperty(ro.prototype,"te",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"_e",{get:function(){return 0!==this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"fe",{get:function(){return this.le},enumerable:!1,configurable:!0}),ro.prototype.de=function(t){0<t.o()&&(this.le=!0,this.ce=t)},ro.prototype.we=function(){var n=zi(),r=zi(),i=zi();return this.he.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new Qi(this.ce,this.ue,n,r,i)},ro.prototype.Ee=function(){this.le=!1,this.he=ho()},ro.prototype.Te=function(t,e){this.le=!0,this.he=this.he.ot(t,e)},ro.prototype.Ie=function(t){this.le=!0,this.he=this.he.remove(t)},ro.prototype.me=function(){this.ae+=1},ro.prototype.Ae=function(){--this.ae},ro.prototype.Re=function(){this.le=!0,this.ue=!0},ro),eo=(no.prototype.be=function(t){for(var e=0,n=t.ie;e<n.length;e++){var r=n[e];t.re instanceof ru?this.ve(r,t.re):t.re instanceof iu&&this.Se(r,t.key,t.re)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Se(s,t.key,t.re)}},no.prototype.De=function(n){var r=this;this.Ce(n,function(t){var e=r.Ne(t);switch(n.state){case 0:r.xe(t)&&e.de(n.resumeToken);break;case 1:e.Ae(),e._e||e.Ee(),e.de(n.resumeToken);break;case 2:e.Ae(),e._e||r.removeTarget(t);break;case 3:r.xe(t)&&(e.Re(),e.de(n.resumeToken));break;case 4:r.xe(t)&&(r.Fe(t),e.de(n.resumeToken));break;default:kr()}})},no.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ge.forEach(function(t,e){r.xe(e)&&n(e)})},no.prototype.ke=function(t){var e=t.targetId,n=t.oe.count,t=this.Oe(e);t&&(Ei(t=t.target)?0===n?(t=new ui(t.path),this.Se(e,t,new iu(t,ri.min()))):Pr(1===n):this.Me(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},no.prototype.$e=function(r){var i=this,o=new Map;this.ge.forEach(function(t,e){var n=i.Oe(e);n&&(t.te&&Ei(n.target)&&(n=new ui(n.target.path),null!==i.Ve.get(n)||i.Le(e,n)||i.Se(e,n,new iu(n,r))),t.fe&&(o.set(e,t.we()),t.Ee()))});var s=zi();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.Oe(t);return!t||2===t.et||(n=!1)}),n&&(s=s.add(t))});var t=new Yi(r,o,this.pe,this.Ve,s);return this.Ve=Ui,this.ye=co(),this.pe=new Ci(Vr),t},no.prototype.ve=function(t,e){var n;this.xe(t)&&(n=this.Le(t,e.key)?2:0,this.Ne(t).Te(e.key,n),this.Ve=this.Ve.ot(e.key,e),this.ye=this.ye.ot(e.key,this.Be(e.key).add(t)))},no.prototype.Se=function(t,e,n){var r;this.xe(t)&&(r=this.Ne(t),this.Le(t,e)?r.Te(e,1):r.Ie(e),this.ye=this.ye.ot(e,this.Be(e).delete(t)),n&&(this.Ve=this.Ve.ot(e,n)))},no.prototype.removeTarget=function(t){this.ge.delete(t)},no.prototype.Me=function(t){var e=this.Ne(t).we();return this.Pe.qe(t).size+e.ee.size-e.se.size},no.prototype.me=function(t){this.Ne(t).me()},no.prototype.Ne=function(t){var e=this.ge.get(t);return e||(e=new to,this.ge.set(t,e)),e},no.prototype.Be=function(t){var e=this.ye.get(t);return e||(e=new Ci(Vr),this.ye=this.ye.ot(t,e)),e},no.prototype.xe=function(t){var e=null!==this.Oe(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Oe=function(t){var e=this.ge.get(t);return e&&e._e?null:this.Pe.Ue(t)},no.prototype.Fe=function(e){var n=this;this.ge.set(e,new to),this.Pe.qe(e).forEach(function(t){n.Se(e,t,null)})},no.prototype.Le=function(t,e){return this.Pe.qe(t).has(e)},no);function no(t){this.Pe=t,this.ge=new Map,this.Ve=Ui,this.ye=co(),this.pe=new Ci(Vr)}function ro(){this.ae=0,this.he=ho(),this.ce=Ur.u,this.ue=!1,this.le=!0}function io(t,e,n,r,i){this.resumeToken=t,this.te=e,this.ee=n,this.ne=r,this.se=i}function oo(t,e,n,r,i){this.nt=t,this.zt=e,this.Ht=n,this.Jt=r,this.Yt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Kt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function uo(){this.qt=new xi(ui.D)}function ao(n){this.D=n?function(t,e){return n(t,e)||ui.D(t.key,e.key)}:function(t,e){return ui.D(t.key,e.key)},this.$t=Fi,this.Lt=new xi(this.D)}function co(){return new xi(ui.D)}function ho(){return new xi(ui.D)}function fo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function lo(t){t=Io(t.mapValue.fields.__local_write_time__.timestampValue);return new ni(t.seconds,t.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:kr()}function vo(r,i){var t,e=yo(r);if(e!==yo(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Io(r.timestampValue),t=Io(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,_o(r.bytesValue).isEqual(_o(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Eo((t=r).geoPointValue.latitude)===Eo(e.geoPointValue.latitude)&&Eo(t.geoPointValue.longitude)===Eo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Eo(t.integerValue)===Eo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Eo(t.doubleValue),e=Eo(e.doubleValue);return t===e?vi(t)===vi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return Cr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Qr(e)!==Qr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!vo(e[t],n[t])))return!1;return!0}();default:return kr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i=yo(t),o=yo(e);if(i!==o)return Vr(i,o);switch(i){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return n=e,r=Eo(t.integerValue||t.doubleValue),n=Eo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(lo(t),lo(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){t=_o(t),e=_o(e);return t.h(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=Vr(Eo(i.latitude),Eo(r.latitude)))?n:Vr(Eo(i.longitude),Eo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Vr(r[s],o[s]);if(0!==u)return u;u=mo(n[r[s]],i[o[s]]);if(0!==u)return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=Io(t),t=Io(e),e=Vr(n.seconds,t.seconds);return 0!==e?e:Vr(n.nanos,t.nanos)}function bo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=Io(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?_o(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,ui.J(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):kr();var e}(t)}function Io(t){if(Pr(!!t),"string"!=typeof t)return{seconds:Eo(t.seconds),nanos:Eo(t.nanos)};var e=0,n=po.exec(t);Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Eo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function _o(t){return"string"==typeof t?Ur.fromBase64String(t):Ur.fromUint8Array(t)}function To(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.B()}}function Ao(t){return t&&"integerValue"in t}function No(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function Do(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xo(t){return t&&"mapValue"in t}var Oo={asc:"ASCENDING",desc:"DESCENDING"},ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Po=function(t,e){this._=t,this.Ke=e};function Lo(t){return{integerValue:""+t}}function Ro(t,e){if(t.Ke){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:vi(e)?"-0":e}}function Vo(t,e){return gi(e)?Lo(e):Ro(t,e)}function Co(t,e){return t.Ke?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Mo(t,e){return t.Ke?e.toBase64():e.toUint8Array()}function Uo(t){return Pr(!!t),ri.V((t=Io(t),new ni(t.seconds,t.nanos)))}function jo(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).B()}function qo(t){t=ii.q(t);return Pr(is(t)),t}function Fo(t,e){return jo(t._,e.path)}function Go(t,e){e=qo(e);return Pr(e.get(1)===t._.projectId),Pr(!e.get(3)&&!t._.database||e.get(3)===t._.database),new ui(Ko(e))}function Bo(t,e){return jo(t._,e)}function zo(t){t=qo(t);return 4===t.length?ii.U():Ko(t)}function Ho(t){return new ii(["projects",t._.projectId,"databases",t._.database]).B()}function Ko(t){return Pr(4<t.length&&"documents"===t.get(4)),t.N(5)}function Wo(t,e,n){return{name:Fo(t,e),fields:n.proto.mapValue.fields}}function Xo(t,e){var n,r,i;if(e instanceof Vs)n={update:Wo(t,e.key,e.value)};else if(e instanceof Ks)n={delete:Fo(t,e.key)};else if(e instanceof Cs)n={update:Wo(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.B())}),{fieldPaths:r})};else if(e instanceof Fs)n={transform:{document:Fo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof as)return{fieldPath:t.field.B(),setToServerValue:"REQUEST_TIME"};if(e instanceof cs)return{fieldPath:t.field.B(),appendMissingElements:{values:e.elements}};if(e instanceof ds)return{fieldPath:t.field.B(),removeAllFromArray:{values:e.elements}};if(e instanceof ms)return{fieldPath:t.field.B(),increment:e.We};throw kr()})}};else{if(!(e instanceof Ws))return kr();n={verify:Fo(t,e.key)}}return e.Ge.je||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,Co(e,t.v()))}:void 0!==i.exists?{exists:i.exists}:kr()),n}function Yo(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ns.updateTime(Uo(o.updateTime)):void 0!==o.exists?Ns.exists(o.exists):Ns.ze():Ns.ze();if(t.update){t.update.name;var r=Go(e,t.update.name),i=new Xs({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new Es(o.map(function(t){return si.G(t)})));return new Cs(r,i,o,n)}return new Vs(r,i,n)}if(t.delete){var s=Go(e,t.delete);return new Ks(s,n)}if(t.transform){i=Go(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Pr("REQUEST_TIME"===e.setToServerValue),r=new as):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new cs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new ds(n)):"increment"in e?r=new ms(t,e.increment):kr();e=si.G(e.fieldPath);return new _s(e,r)}(e,t)});return Pr(!0===n.exists),new Fs(i,s)}if(t.verify){t=Go(e,t.verify);return new Ws(t,n)}return kr()}function Qo(t,e){return{documents:[Bo(t,e.path)]}}function Jo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.F()),n.structuredQuery.from=[{collectionId:r.O()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Do(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Do(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:es(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:es(t.field),op:(e=t.op,ko[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:es((t=t).field),direction:(t=t.dir,Oo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ke||yi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Zo(e.endAt)),n}function $o(t){var e=zo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[rs(t)]:void 0!==t.fieldFilter?[(n=t,Du.create(ns(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new na(ns((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=yi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ts(n.startAt));var u=null;return n.endAt&&(u=ts(n.endAt)),mu(hu(e,i,t,o,r,"F",s,u))}function Zo(t){return{before:t.before,values:t.position}}function ts(t){var e=!!t.before,t=t.values||[];return new Xu(t,e)}function es(t){return{fieldPath:t.B()}}function ns(t){return si.G(t.fieldPath)}function rs(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ns(t.unaryFilter.field);return Du.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ns(t.unaryFilter.field);return Du.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=ns(t.unaryFilter.field);return Du.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=ns(t.unaryFilter.field);return Du.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}function is(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.He=void 0};function os(t,e){return t instanceof ms?Ao(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ss,us,as=(n(fs,us=h),fs),cs=(n(hs,ss=h),hs);function hs(t){var e=this;return(e=ss.call(this)||this).elements=t,e}function fs(){return null!==us&&us.apply(this,arguments)||this}function ls(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ps,ds=(n(ys,ps=h),ys);function ys(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function vs(t,e){for(var n=Is(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var gs,ms=(n(ws,gs=h),ws);function ws(t,e){var n=this;return(n=gs.call(this)||this).serializer=t,n.We=e,n}function bs(t){return Eo(t.integerValue||t.doubleValue)}function Is(t){return No(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Es=(Ts.prototype.Je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].M(t))return!0;return!1},Ts.prototype.isEqual=function(t){return Cr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ts),_s=function(t,e){this.field=t,this.transform=e};function Ts(t){(this.fields=t).sort(si.D)}function As(t,e){this.version=t,this.transformResults=e}var Ns=(Ss.ze=function(){return new Ss},Ss.exists=function(t){return new Ss(void 0,t)},Ss.updateTime=function(t){return new Ss(t)},Object.defineProperty(Ss.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ss.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ss);function Ss(t,e){this.updateTime=t,this.exists=e}function Ds(t,e){return void 0!==t.updateTime?e instanceof ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ru}Ie=function(){};function xs(t,e,n){return t instanceof Vs?new ru(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Cs?function(t,e,n){if(!Ds(t.Ge,e))return new ou(t.key,n.version);e=js(t,e);return new ru(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Fs?function(t,e,n){if(Pr(null!=n.transformResults),!Ds(t.Ge,e))return new ou(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof ru&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof cs?ls(o,s):o instanceof ds?vs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Bs(t,r.data(),e);return new ru(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new iu(t.key,n.version,{hasCommittedMutations:!0})}function Os(t,e,n,r){return t instanceof Vs?function(t,e){if(!Ds(t.Ge,e))return e;e=Ps(e);return new ru(t.key,e,t.value,{Ye:!0})}(t,e):t instanceof Cs?function(t,e){if(!Ds(t.Ge,e))return e;var n=Ps(e),e=js(t,e);return new ru(t.key,n,e,{Ye:!0})}(t,e):t instanceof Fs?function(t,e,n,r){if(!Ds(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof ru&&(h=n.field(a.field)),null===h&&r instanceof ru&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof as?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof cs?ls(c,i):c instanceof ds?vs(c,i):(c=os(h=c,i),i=bs(c)+bs(h.We),Ao(c)&&Ao(h.We)?Lo(i):Ro(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Bs(t,i.data(),r);return new ru(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Ds((t=t).Ge,e)?new iu(t.key,ri.min()):e)}function ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Cr(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof cs&&e instanceof cs||t instanceof ds&&e instanceof ds?Cr(t.elements,e.elements,vo):t instanceof ms&&e instanceof ms?vo(t.We,e.We):t instanceof as&&e instanceof as)}))}function Ps(t){return t instanceof ru?t.version:ri.min()}var Ls,Rs,Vs=(n(Us,Rs=Ie),Us),Cs=(n(Ms,Ls=Ie),Ms);function Ms(t,e,n,r){var i=this;return(i=Ls.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Us(t,e,n){var r=this;return(r=Rs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function js(t,e){return n=t,e=e instanceof ru?e.data():Xs.empty(),r=new Ys(e),n.Qe.fields.forEach(function(t){var e;t.P()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Xe();var n,r}var qs,Fs=(n(Gs,qs=Ie),Gs);function Gs(t,e){var n=this;return(n=qs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ns.exists(!0),n}function Bs(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Xe()}var zs,Hs,Ks=(n(Zs,Hs=Ie),Zs),Ws=(n($s,zs=Ie),$s),Xs=(Js.empty=function(){return new Js({mapValue:{}})},Js.prototype.field=function(t){if(t.P())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},Js.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Js),Ys=(Qs.prototype.set=function(t,e){return this.en(t,e),this},Qs.prototype.delete=function(t){return this.en(t,null),this},Qs.prototype.en=function(t,e){for(var n=this.tn,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.O(),e)},Qs.prototype.Xe=function(){var t=this.nn(si.U(),this.tn);return null!=t?new Xs(t):this.Ze},Qs.prototype.nn=function(r,t){var i=this,o=!1,e=this.Ze.field(r),s=xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.nn(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Qs);function Qs(t){void 0===t&&(t=Xs.empty()),this.Ze=t,this.tn=new Map}function Js(t){this.proto=t}function $s(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Ge=e,n.type=4,n}function Zs(t,e){var n=this;return(n=Hs.call(this)||this).key=t,n.Ge=e,n.type=3,n}var tu,eu,nu,Ee=function(t,e){this.key=t,this.version=e},ru=(n(cu,nu=Ee),cu.prototype.field=function(t){return this.sn.field(t)},cu.prototype.data=function(){return this.sn},cu.prototype.rn=function(){return this.sn.proto},cu.prototype.isEqual=function(t){return t instanceof cu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.sn.isEqual(t.sn)},cu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.sn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(cu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),cu),iu=(n(au,eu=Ee),au.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),au.prototype.isEqual=function(t){return t instanceof au&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},au),ou=(n(uu,tu=Ee),uu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),su=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.on=n,this.filters=r,this.limit=i,this.an=o,this.startAt=s,this.endAt=u,this.hn=null,this.cn=null,this.startAt,this.endAt};function uu(){return null!==tu&&tu.apply(this,arguments)||this}function au(t,e,n){var r=this;return(r=eu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function cu(t,e,n,r){var i=this;return(i=nu.call(this,t,e)||this).sn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function hu(t,e,n,r,i,o,s,u){return new su(t,e,n,r,i,o,s,u)}function fu(t){return new su(t)}function lu(t){return!yi(t.limit)&&"F"===t.an}function pu(t){return!yi(t.limit)&&"L"===t.an}function du(t){return 0<t.on.length?t.on[0].field:null}function yu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function vu(t){return null!==t.collectionGroup}function gu(t){var e=t;if(null===e.hn){e.hn=[];var n=yu(e),t=du(e);if(null!==n&&null===t)n.W()||e.hn.push(new na(n)),e.hn.push(new na(si.j(),"asc"));else{for(var r=!1,i=0,o=e.on;i<o.length;i++){var s=o[i];e.hn.push(s),s.field.W()&&(r=!0)}r||(n=0<e.on.length?e.on[e.on.length-1].dir:"asc",e.hn.push(new na(si.j(),n)))}}return e.hn}function mu(t){var e=t;if(!e.cn)if("F"===e.an)e.cn=wi(e.path,e.collectionGroup,gu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=gu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new na(o.field,s))}var u=e.endAt?new Xu(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Xu(e.startAt.position,!e.startAt.before):null;e.cn=wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function wu(t,e,n){return new su(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bu(t,e){return new su(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,e,t.endAt)}function Iu(t,e){return new su(t.path,t.collectionGroup,t.on.slice(),t.filters.slice(),t.limit,t.an,t.startAt,e)}function Eu(t,e){return Ii(mu(t),mu(e))&&t.an===e.an}function _u(t){return bi(mu(t))+"|lt:"+t.an}function Tu(t){return"Query(target="+(e=mu(t),n=e.path.B(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.B()+" "+t.op+" "+bo(t.value)}).join(", ")+"]"),yi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.B()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Zu(e.startAt)),e.endAt&&(n+=", endAt: "+Zu(e.endAt)),"Target("+n+")")+"; limitType="+t.an+")";var e,n}function Au(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.Y(e.collectionGroup)&&e.path.M(n):ui.X(e.path)?e.path.isEqual(n):e.path.$(n))&&function(t){for(var e=0,n=i.on;e<n.length;e++){var r=n[e];if(!r.field.W()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ta(t.startAt,gu(t),n))&&(!t.endAt||!ta(t.endAt,gu(t),n)));var e,n}function Nu(u){return function(t,e){for(var n=!1,r=0,i=gu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.W()?ui.D(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?mo(n,t):kr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.W()}return 0}}var Su,Du=(n(xu,Su=function(){}),xu.create=function(t,e,n){return t.W()?"in"===e||"not-in"===e?this.ln(t,e,n):new Lu(t,e,n):"array-contains"===e?new zu(t,n):"in"===e?new Hu(t,n):"not-in"===e?new Ku(t,n):"array-contains-any"===e?new Wu(t,n):new xu(t,e,n)},xu.ln=function(t,e,n){return new("in"===e?Ru:Vu)(t,n)},xu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this._n(mo(t,this.value)):null!==t&&yo(this.value)===yo(t)&&this._n(mo(t,this.value))},xu.prototype._n=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},xu.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},xu);function xu(t,e,n){var r=this;return(r=Su.call(this)||this).field=t,r.op=e,r.value=n,r}var Ou,ku,Pu,Lu=(n(Uu,Pu=Du),Uu.prototype.matches=function(t){t=ui.D(t.key,this.key);return this._n(t)},Uu),Ru=(n(Mu,ku=Du),Mu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Mu),Vu=(n(Cu,Ou=Du),Cu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Cu);function Cu(t,e){var n=this;return(n=Ou.call(this,t,"not-in",e)||this).keys=ju(0,e),n}function Mu(t,e){var n=this;return(n=ku.call(this,t,"in",e)||this).keys=ju(0,e),n}function Uu(t,e,n){var r=this;return(r=Pu.call(this,t,e,n)||this).key=ui.J(n.referenceValue),r}function ju(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ui.J(t.referenceValue)})}var qu,Fu,Gu,Bu,zu=(n($u,Bu=Du),$u.prototype.matches=function(t){t=t.field(this.field);return No(t)&&go(t.arrayValue,this.value)},$u),Hu=(n(Ju,Gu=Du),Ju.prototype.matches=function(t){t=t.field(this.field);return null!==t&&go(this.value.arrayValue,t)},Ju),Ku=(n(Qu,Fu=Du),Qu.prototype.matches=function(t){if(go(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!go(this.value.arrayValue,t)},Qu),Wu=(n(Yu,qu=Du),Yu.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!No(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Yu),Xu=function(t,e){this.position=t,this.before=e};function Yu(t,e){return qu.call(this,t,"array-contains-any",e)||this}function Qu(t,e){return Fu.call(this,t,"not-in",e)||this}function Ju(t,e){return Gu.call(this,t,"in",e)||this}function $u(t,e){return Bu.call(this,t,"array-contains",e)||this}function Zu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function ta(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.W()?ui.D(ui.J(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ea(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var na=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ra(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ia,oa=(da.prototype.reset=function(){this.In=0},da.prototype.Rn=function(){this.In=this.Tn},da.prototype.Pn=function(t){var e=this;this.cancel();var n=Math.floor(this.In+this.gn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.In+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mn=this.fn.Vn(this.dn,i,function(){return e.An=Date.now(),t()}),this.In*=this.En,this.In<this.wn&&(this.In=this.wn),this.In>this.Tn&&(this.In=this.Tn)},da.prototype.yn=function(){null!==this.mn&&(this.mn.pn(),this.mn=null)},da.prototype.cancel=function(){null!==this.mn&&(this.mn.cancel(),this.mn=null)},da.prototype.gn=function(){return(Math.random()-.5)*this.In},da),sa=(pa.prototype.catch=function(t){return this.next(void 0,t)},pa.prototype.next=function(r,i){var o=this;return this.Dn&&kr(),this.Dn=!0,this.Sn?this.error?this.Cn(i,this.error):this.Nn(r,this.result):new pa(function(e,n){o.bn=function(t){o.Nn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},pa.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},pa.prototype.Fn=function(t){try{var e=t();return e instanceof pa?e:pa.resolve(e)}catch(t){return pa.reject(t)}},pa.prototype.Nn=function(t,e){return t?this.Fn(function(){return t(e)}):pa.resolve(e)},pa.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):pa.reject(e)},pa.resolve=function(n){return new pa(function(t,e){t(n)})},pa.reject=function(n){return new pa(function(t,e){e(n)})},pa.kn=function(t){return new pa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},pa.On=function(t){for(var n=pa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?pa.resolve(t):e()})}(r[e]);return n},pa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.kn(i)},pa),ua=(la.delete=function(t){return Sr("SimpleDb","Removing database:",t),ba(window.indexedDB.deleteDatabase(t)).xn()},la.Ln=function(){if("undefined"==typeof indexedDB)return!1;if(la.Bn())return!0;var t=p(),e=la.$n(t),n=0<e&&e<10,e=la.qn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},la.Bn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Un)},la.Kn=function(t,e){return t.store(e)},la.$n=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},la.qn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},la.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Sr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new ca(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new _r(Er.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ca(o,t))},r.onupgradeneeded=function(t){Sr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Mn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Sr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},la.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},la.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=va.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),sa.reject(t)}).xn(),r={},n.catch(function(){}),[4,e.Gn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Sr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},la.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},la),aa=(Object.defineProperty(fa.prototype,"Sn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(fa.prototype,"Yn",{get:function(){return this.Jn},enumerable:!1,configurable:!0}),Object.defineProperty(fa.prototype,"cursor",{set:function(t){this.zn=t},enumerable:!1,configurable:!0}),fa.prototype.done=function(){this.Hn=!0},fa.prototype.Xn=function(t){this.Jn=t},fa.prototype.delete=function(){return ba(this.zn.delete())},fa),ca=(n(ha,ia=_r),ha);function ha(t,e){var n=this;return(n=ia.call(this,Er.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function fa(t){this.zn=t,this.Hn=!1,this.Jn=null}function la(t,e,n){this.name=t,this.version=e,this.Mn=n,12.2===la.$n(p())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function pa(t){var e=this;this.bn=null,this.vn=null,this.result=void 0,this.error=void 0,this.Sn=!1,this.Dn=!1,t(function(t){e.Sn=!0,e.result=t,e.bn&&e.bn(t)},function(t){e.Sn=!0,e.error=t,e.vn&&e.vn(t)})}function da(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.fn=t,this.dn=e,this.wn=n,this.En=r,this.Tn=i,this.In=0,this.mn=null,this.An=Date.now(),this.reset()}function ya(t){return"IndexedDbTransactionError"===t.name}var va=(wa.open=function(t,e,n,r){try{return new wa(e,t.transaction(r,n))}catch(t){throw new ca(e,t)}},Object.defineProperty(wa.prototype,"Gn",{get:function(){return this.Zn.promise},enumerable:!1,configurable:!0}),wa.prototype.abort=function(t){t&&this.Zn.reject(t),this.aborted||(Sr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},wa.prototype.store=function(t){t=this.transaction.objectStore(t);return new ga(t)},wa),ga=(ma.prototype.put=function(t,e){t=void 0!==e?(Sr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Sr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return ba(t)},ma.prototype.add=function(t){return Sr("SimpleDb","ADD",this.store.name,t,t),ba(this.store.add(t))},ma.prototype.get=function(e){var n=this;return ba(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Sr("SimpleDb","GET",n.store.name,e,t),t})},ma.prototype.delete=function(t){return Sr("SimpleDb","DELETE",this.store.name,t),ba(this.store.delete(t))},ma.prototype.count=function(){return Sr("SimpleDb","COUNT",this.store.name),ba(this.store.count())},ma.prototype.ts=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.es(e,function(t,e){n.push(e)}).next(function(){return n})},ma.prototype.ns=function(t,e){Sr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.ss=!1;e=this.cursor(e);return this.es(e,function(t,e,n){return n.delete()})},ma.prototype.rs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.es(n,e)},ma.prototype.os=function(r){var t=this.cursor({});return new sa(function(n,e){t.onerror=function(t){t=Ea(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ma.prototype.es=function(t,i){var o=[];return new sa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new aa(n),(t=i(n.primaryKey,n.value,e))instanceof sa&&(t=t.catch(function(t){return e.done(),sa.reject(t)}),o.push(t)),e.Sn?r():null===e.Yn?n.continue():n.continue(e.Yn)):r()}}).next(function(){return sa.kn(o)})},ma.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ma.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ss?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ma);function ma(t){this.store=t}function wa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Zn=new ra,this.transaction.oncomplete=function(){n.Zn.resolve()},this.transaction.onabort=function(){t.error?n.Zn.reject(new ca(e,t.error)):n.Zn.resolve()},this.transaction.onerror=function(t){t=Ea(t.target.error);n.Zn.reject(new ca(e,t))}}function ba(t){return new sa(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=Ea(t.target.error);n(t)}})}var Ia=!1;function Ea(t){var e=ua.$n(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ia||(Ia=!0,setTimeout(function(){throw n},0)),n}}return t}function _a(){return"undefined"!=typeof window?window:null}function Ta(){return"undefined"!=typeof document?document:null}var Aa=(Da._s=function(t,e,n,r,i){i=new Da(t,e,Date.now()+n,r,i);return i.start(n),i},Da.prototype.start=function(t){var e=this;this.fs=setTimeout(function(){return e.ds()},t)},Da.prototype.pn=function(){return this.ds()},Da.prototype.cancel=function(t){null!==this.fs&&(this.clearTimeout(),this.ls.reject(new _r(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Da.prototype.ds=function(){var e=this;this.hs.ws(function(){return null!==e.fs?(e.clearTimeout(),e.op().then(function(t){return e.ls.resolve(t)})):Promise.resolve()})},Da.prototype.clearTimeout=function(){null!==this.fs&&(this.us(this),clearTimeout(this.fs),this.fs=null)},Da),Na=(Object.defineProperty(Sa.prototype,"ps",{get:function(){return this.Is},enumerable:!1,configurable:!0}),Sa.prototype.ws=function(t){this.enqueue(t)},Sa.prototype.bs=function(t){this.vs(),this.Ss(t)},Sa.prototype.Ds=function(){var t;this.Is||(this.Is=!0,(t=Ta())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Sa.prototype.enqueue=function(t){return this.vs(),this.Is?new Promise(function(t){}):this.Ss(t)},Sa.prototype.Cs=function(t){var e=this;this.ws(function(){return e.Ts.push(t),e.Ns()})},Sa.prototype.Ns=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.Vs.reset(),[3,4];case 3:if(!ya(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.Vs.Pn(function(){return n.Ns()}),t.label=5;case 5:return[2]}})})},Sa.prototype.Ss=function(t){var r=this,e=this.Es.then(function(){return r.Ps=!0,t().catch(function(t){throw r.Rs=t,r.Ps=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ps=!1,t})});return this.Es=e},Sa.prototype.Vn=function(t,e,n){var r=this;this.vs(),-1<this.gs.indexOf(t)&&(e=0);n=Aa._s(this,t,e,n,function(t){return r.xs(t)});return this.As.push(n),n},Sa.prototype.vs=function(){this.Rs&&kr()},Sa.prototype.Fs=function(){},Sa.prototype.ks=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Es];case 1:t.sent(),t.label=2;case 2:if(e!==this.Es)return[3,0];t.label=3;case 3:return[2]}})})},Sa.prototype.Os=function(t){for(var e=0,n=this.As;e<n.length;e++)if(n[e].dn===t)return!0;return!1},Sa.prototype.Ms=function(r){var i=this;return this.ks().then(function(){i.As.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.As;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.dn===r)break}return i.ks()})},Sa.prototype.$s=function(t){this.gs.push(t)},Sa.prototype.xs=function(t){t=this.As.indexOf(t);this.As.splice(t,1)},Sa);function Sa(){var e=this;this.Es=Promise.resolve(),this.Ts=[],this.Is=!1,this.As=[],this.Rs=null,this.Ps=!1,this.gs=[],this.Vs=new oa(this,"async_queue_retry"),this.ys=function(){var t=Ta();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Vs.yn()};var t=Ta();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Da(t,e,n,r,i){this.hs=t,this.dn=e,this.cs=n,this.op=r,this.us=i,this.ls=new ra,this.then=this.ls.promise.then.bind(this.ls.promise),this.ls.promise.catch(function(t){})}function xa(t,e){if(Dr("AsyncQueue",e+": "+t),ya(t))return new _r(Er.UNAVAILABLE,e+": "+t);throw t}function Oa(){this.Ls=void 0,this.listeners=[]}function ka(){this.Bs=new ei(_u,Eu),this.onlineState="Unknown",this.qs=new Set}function Pa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Bs.get(n))||(r=!0,i=new Oa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Us(n)];case 2:return o.Ls=t.sent(),[3,4];case 3:return o=t.sent(),o=xa(o,"Initialization of query '"+Tu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Bs.set(n,i),i.listeners.push(u),u.Ks(e.onlineState),i.Ls&&u.Qs(i.Ls)&&Ra(e),[2]}})})}function La(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Bs.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Bs.delete(n),e.Ws(n))]:[2]})})}function Ra(t){t.qs.forEach(function(t){t.next()})}var Va=(Ua.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Xi(t.query,t.docs,t.Kt,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Gs?this.Hs(t)&&(this.js.next(t),o=!0):this.Js(t,this.onlineState)&&(this.Ys(t),o=!0),this.zs=t,o},Ua.prototype.onError=function(t){this.js.error(t)},Ua.prototype.Ks=function(t){this.onlineState=t;var e=!1;return this.zs&&!this.Gs&&this.Js(this.zs,t)&&(this.Ys(this.zs),e=!0),e},Ua.prototype.Js=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Xs&&n||t.docs.P()&&"Offline"!==e)},Ua.prototype.Hs=function(t){if(0<t.docChanges.length)return!0;var e=this.zs&&this.zs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},Ua.prototype.Ys=function(t){t=Xi.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Gs=!0,this.js.next(t)},Ua),Ca=(Ma.prototype.Zs=function(){return null!=this.uid},Ma.prototype.ti=function(){return this.Zs()?"uid:"+this.uid:"anonymous-user"},Ma.prototype.isEqual=function(t){return t.uid===this.uid},Ma);function Ma(t){this.uid=t}function Ua(t,e,n){this.query=t,this.js=e,this.Gs=!1,this.zs=null,this.onlineState="Unknown",this.options=n||{}}Ca.UNAUTHENTICATED=new Ca(null),Ca.ei=new Ca("google-credentials-uid"),Ca.ni=new Ca("first-party-uid");var ja=(qa.prototype.ii=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},qa.prototype.next=function(){var t=++this.previousValue;return this.ri&&this.ri(t),t},qa);function qa(t,e){var n=this;this.previousValue=t,e&&(e.si=function(t){return n.ii(t)},this.ri=function(t){return e.oi(t)})}function Fa(t,e){return"firestore_clients_"+t+"_"+e}function Ga(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Zs()&&(n+="_"+e.uid),n}function Ba(t,e){return"firestore_targets_"+t+"_"+e}ja.ai=-1;var za=(dc.hi=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new dc(t,e,r.state,o):(Dr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},dc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},dc),Ha=(pc.hi=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new pc(t,n.state,i):(Dr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},pc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},pc),Ka=(lc.hi=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Hi,o=0;r&&o<n.activeTargetIds.length;++o)r=gi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new lc(t,i):(Dr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},lc),Wa=(fc.hi=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new fc(e.clientId,e.onlineState):(Dr("SharedClientState","Failed to parse online state: "+t),null)},fc),Xa=(hc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},hc.prototype.li=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},hc.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.L(),updateTimeMs:Date.now()};return JSON.stringify(t)},hc),Ya=(cc.Ln=function(t){return!(!t||!t.localStorage)},cc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this.fi.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this._i&&(i=this.getItem(Fa(this.persistenceKey,r)))&&(o=Ka.hi(r,i))&&(this.Ti=this.Ti.ot(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.yi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.mi;a<c.length;a++)h=c[a],this.Ei(h);return this.mi=[],this.window.addEventListener("unload",function(){return f.Di()}),this.Ii=!0,[2]}})})},cc.prototype.oi=function(t){this.setItem(this.Ri,JSON.stringify(t))},cc.prototype.Ci=function(){return this.Ni(this.Ti)},cc.prototype.xi=function(n){var r=!1;return this.Ti.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},cc.prototype.Fi=function(t){this.ki(t,"pending")},cc.prototype.Oi=function(t,e,n){this.ki(t,e,n),this.Mi(t)},cc.prototype.$i=function(t){var e,n="not-current";return this.xi(t)&&(!(e=this.storage.getItem(Ba(this.persistenceKey,t)))||(e=Ha.hi(t,e))&&(n=e.state)),this.Li.ui(t),this.bi(),n},cc.prototype.Bi=function(t){this.Li.li(t),this.bi()},cc.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},cc.prototype.Ui=function(t){this.removeItem(Ba(this.persistenceKey,t))},cc.prototype.Ki=function(t,e,n){this.Qi(t,e,n)},cc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},cc.prototype.ji=function(t){this.Gi(t)},cc.prototype.Di=function(){this.Ii&&(this.window.removeEventListener("storage",this.wi),this.removeItem(this.Ai),this.Ii=!1)},cc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Sr("SharedClientState","READ",t,e),e},cc.prototype.setItem=function(t,e){Sr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},cc.prototype.removeItem=function(t){Sr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},cc.prototype.Ei=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Sr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ai)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.fn.Cs(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ii){if(null!==s.key)if(this.Pi.test(s.key)){if(null==s.newValue)return e=this.zi(s.key),[2,this.Hi(e,null)];if(e=this.Ji(s.key,s.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.gi.test(s.key)){if(null!==s.newValue&&(n=this.Yi(s.key,s.newValue)))return[2,this.Xi(n)]}else if(this.Vi.test(s.key)){if(null!==s.newValue&&(r=this.Zi(s.key,s.newValue)))return[2,this.tr(r)]}else if(s.key===this.yi){if(null!==s.newValue&&(i=this.vi(s.newValue)))return[2,this.Si(i)]}else s.key===this.Ri&&(o=function(t){var e=ja.ai;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==ja.ai&&this.si(o)}else this.mi.push(s);return[2]})})})}},Object.defineProperty(cc.prototype,"Li",{get:function(){return this.Ti.get(this._i)},enumerable:!1,configurable:!0}),cc.prototype.bi=function(){this.setItem(this.Ai,this.Li.ci())},cc.prototype.ki=function(t,e,n){n=new za(this.currentUser,t,e,n),t=Ga(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ci())},cc.prototype.Mi=function(t){t=Ga(this.persistenceKey,this.currentUser,t);this.removeItem(t)},cc.prototype.Gi=function(t){t={clientId:this._i,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(t))},cc.prototype.Qi=function(t,e,n){var r=Ba(this.persistenceKey,t),n=new Ha(t,e,n);this.setItem(r,n.ci())},cc.prototype.zi=function(t){t=this.Pi.exec(t);return t?t[1]:null},cc.prototype.Ji=function(t,e){t=this.zi(t);return Ka.hi(t,e)},cc.prototype.Yi=function(t,e){var n=this.gi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return za.hi(new Ca(n),t,e)},cc.prototype.Zi=function(t,e){t=this.Vi.exec(t),t=Number(t[1]);return Ha.hi(t,e)},cc.prototype.vi=function(t){return Wa.hi(t)},cc.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fi.er(e.batchId,e.state,e.error)]:(Sr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},cc.prototype.tr=function(t){return this.fi.nr(t.targetId,t.state,t.error)},cc.prototype.Hi=function(t,e){var n=this,r=e?this.Ti.ot(t,e):this.Ti.remove(t),i=this.Ni(this.Ti),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fi.sr(s,u).then(function(){n.Ti=r})},cc.prototype.Si=function(t){this.Ti.get(t.clientId)&&this.di(t.onlineState)},cc.prototype.Ni=function(t){var n=Hi;return t.forEach(function(t,e){n=n.Ot(e.activeTargetIds)}),n},cc),Qa=(ac.prototype.Fi=function(t){},ac.prototype.Oi=function(t,e,n){},ac.prototype.$i=function(t){return this.ir.ui(t),this.rr[t]||"not-current"},ac.prototype.Ki=function(t,e,n){this.rr[t]=e},ac.prototype.Bi=function(t){this.ir.li(t)},ac.prototype.qi=function(t){return this.ir.activeTargetIds.has(t)},ac.prototype.Ui=function(t){delete this.rr[t]},ac.prototype.Ci=function(){return this.ir.activeTargetIds},ac.prototype.xi=function(t){return this.ir.activeTargetIds.has(t)},ac.prototype.start=function(){return this.ir=new Xa,Promise.resolve()},ac.prototype.Wi=function(t,e,n){},ac.prototype.ji=function(t){},ac.prototype.Di=function(){},ac.prototype.oi=function(t){},ac),Ja=(uc.prototype.hr=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=xs(o,e,r[i]))}return e},uc.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Os(i,e,e,this.ar))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Os(a,e,o,this.ar))}return e},uc.prototype.lr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.ot(t.key,e))}),i},uc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},uc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,ks)&&Cr(this.baseMutations,t.baseMutations,ks)},uc),$a=(sc.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.ot(i[o].key,n[o].version);return new sc(t,e,n,r)},sc),h=(Object.defineProperty(oc.prototype,"readTime",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),oc.prototype.Ir=function(t,e){this.mr(),this.readTime=e,this.wr.set(t.key,t)},oc.prototype.Ar=function(t,e){this.mr(),e&&(this.readTime=e),this.wr.set(t,null)},oc.prototype.Rr=function(t,e){this.mr();var n=this.wr.get(e);return void 0!==n?sa.resolve(n):this.Pr(t,e)},oc.prototype.getEntries=function(t,e){return this.gr(t,e)},oc.prototype.apply=function(t){return this.mr(),this.Er=!0,this.Vr(t)},oc.prototype.mr=function(){},oc),Za="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(ic.prototype.pr=function(t){this.yr.push(t)},ic.prototype.br=function(){this.yr.forEach(function(t){return t()})},ic),tc=(rc.prototype.Cr=function(e,n){var r=this;return this.Sr.Nr(e,n).next(function(t){return r.Fr(e,n,t)})},rc.prototype.Fr=function(t,r,i){return this.vr.Rr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},rc.prototype.kr=function(t,e,i){var o=Ui;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.ot(t,e)}),o},rc.prototype.Or=function(e,t){var n=this;return this.vr.getEntries(e,t).next(function(t){return n.Mr(e,t)})},rc.prototype.Mr=function(e,r){var i=this;return this.Sr.$r(e,r).next(function(t){var t=i.kr(e,r,t),n=Ui;return t.forEach(function(t,e){e=e||new iu(t,ri.min()),n=n.ot(t,e)}),n})},rc.prototype.Lr=function(t,e,n){return r=e,ui.X(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Br(t,e.path):vu(e)?this.qr(t,e,n):this.Ur(t,e,n);var r},rc.prototype.Br=function(t,e){return this.Cr(t,new ui(e)).next(function(t){var e=Fi;return t instanceof ru&&(e=e.ot(t.key,t)),e})},rc.prototype.qr=function(n,r,i){var o=this,s=r.collectionGroup,u=Fi;return this.Dr.Kr(n,s).next(function(t){return sa.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new su(t,null,e.on.slice(),e.filters.slice(),e.limit,e.an,e.startAt,e.endAt));return o.Ur(n,e,i).next(function(t){t.forEach(function(t,e){u=u.ot(t,e)})})}).next(function(){return u})})},rc.prototype.Ur=function(e,n,t){var c,h,r=this;return this.vr.Lr(e,n,t).next(function(t){return c=t,r.Sr.Qr(e,n)}).next(function(t){return h=t,r.Wr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Os(s,a,a,r.ar);c=a instanceof ru?c.ot(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Au(n,e)||(c=c.remove(t))}),c})},rc.prototype.Wr=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.vr.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ru&&(c=c.ot(t,e))}),c})},rc),ec=(nc.zr=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new nc(t,e.fromCache,n,r)},nc);function nc(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Gr=r}function rc(t,e,n){this.vr=t,this.Sr=e,this.Dr=n}function ic(){this.yr=[]}function oc(){this.wr=new ei(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Er=!1}function sc(t,e,n,r){this.batch=t,this._r=e,this.cr=n,this.dr=r}function uc(t,e,n,r){this.batchId=t,this.ar=e,this.baseMutations=n,this.mutations=r}function ac(){this.ir=new Xa,this.rr={},this.di=null,this.si=null}function cc(t,e,n,r,i){this.window=t,this.fn=e,this.persistenceKey=n,this._i=r,this.fi=null,this.di=null,this.si=null,this.wi=this.Ei.bind(this),this.Ti=new xi(Vr),this.Ii=!1,this.mi=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ai=Fa(this.persistenceKey,this._i),this.Ri="firestore_sequence_number_"+this.persistenceKey,this.Ti=this.Ti.ot(this._i,new Xa),this.Pi=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.gi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Vi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.wi)}function hc(){this.activeTargetIds=Hi}function fc(t,e){this.clientId=t,this.onlineState=e}function lc(t,e){this.clientId=t,this.activeTargetIds=e}function pc(t,e,n){this.targetId=t,this.state=e,this.error=n}function dc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function yc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=Vr(n,t);return 0===t?Vr(r,e):t}var vc=(bc.prototype.Yr=function(){return++this.Jr},bc.prototype.Xr=function(t){var e=[t,this.Yr()];this.buffer.size<this.Hr?this.buffer=this.buffer.add(e):yc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(bc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),bc),gc={Zr:!1,eo:0,no:0,so:0},mc=(wc.ao=function(t){return new wc(t,wc.ho,wc.co)},wc);function wc(t,e,n){this.io=t,this.ro=e,this.oo=n}function bc(t){this.Hr=t,this.buffer=new Ci(yc),this.Jr=0}mc.uo=-1,mc.lo=1048576,mc._o=41943040,mc.ho=10,mc.co=1e3,mc.fo=new mc(mc._o,mc.ho,mc.co),mc.do=new mc(mc.uo,0,0);var Ic=(Tc.prototype.start=function(t){this.wo.params.io!==mc.uo&&this.Io(t)},Tc.prototype.stop=function(){this.To&&(this.To.cancel(),this.To=null)},Object.defineProperty(Tc.prototype,"Ii",{get:function(){return null!==this.To},enumerable:!1,configurable:!0}),Tc.prototype.Io=function(n){var t=this,e=this.Eo?3e5:6e4;Sr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.To=this.hs.Vn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.To=null,this.Eo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.mo(this.wo)];case 2:return t.sent(),[3,7];case 3:return ya(e=t.sent())?(Sr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,nf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Io(n)];case 8:return t.sent(),[2]}})})})},Tc),Ec=(_c.prototype.Ro=function(t,e){return this.Ao.Po(t).next(function(t){return Math.floor(e/100*t)})},_c.prototype.Vo=function(t,e){var n=this;if(0===e)return sa.resolve(ja.ai);var r=new vc(e);return this.Ao.Ce(t,function(t){return r.Xr(t.sequenceNumber)}).next(function(){return n.Ao.yo(t,function(t){return r.Xr(t)})}).next(function(){return r.maxValue})},_c.prototype.po=function(t,e,n){return this.Ao.po(t,e,n)},_c.prototype.bo=function(t,e){return this.Ao.bo(t,e)},_c.prototype.vo=function(e,n){var r=this;return this.params.io===mc.uo?(Sr("LruGarbageCollector","Garbage collection skipped; disabled"),sa.resolve(gc)):this.So(e).next(function(t){return t<r.params.io?(Sr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.io),gc):r.Do(e,n)})},_c.prototype.So=function(t){return this.Ao.So(t)},_c.prototype.Do=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ro(e,this.params.ro).next(function(t){return i=t>h.params.oo?(Sr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.oo+" from "+t),h.params.oo):t,s=Date.now(),h.Vo(e,i)}).next(function(t){return r=t,u=Date.now(),h.po(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.bo(e,r)}).next(function(t){return c=Date.now(),Nr()<=l.DEBUG&&Sr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),sa.resolve({Zr:!0,eo:i,no:o,so:t})})},_c);function _c(t,e){this.Ao=t,this.params=e}function Tc(t,e){this.wo=t,this.hs=e,this.Eo=!1,this.To=null}function Ac(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Nc(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return Nc(e)}function Nc(t){return t+"\x01\x01"}function Sc(t){var e=t.length;if(Pr(2<=e),2===e)return Pr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),ii.U();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&kr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:kr()}o=s+2}return new ii(r)}var Dc=function(t){this.Co=t};function xc(t,e){if(e.document)return n=t.Co,r=e.document,i=!!e.hasCommittedMutations,t=Go(n,r.name),n=Uo(r.updateTime),r=new Xs({mapValue:{fields:r.fields}}),new ru(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=ui.Z(e.noDocument.path),o=Rc(e.noDocument.readTime);return new iu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){o=ui.Z(e.unknownDocument.path),e=Rc(e.unknownDocument.version);return new ou(o,e)}return kr()}function Oc(t,e,n){var r=kc(n),n=e.key.path.F().L();if(e instanceof ru){var i={name:Fo(i=t.Co,(o=e).key),fields:o.rn().mapValue.fields,updateTime:Co(i,o.version.v())},o=e.hasCommittedMutations;return new dh(null,null,i,o,r,n)}if(e instanceof iu){var i=e.key.path.L(),o=Lc(e.version),s=e.hasCommittedMutations;return new dh(null,new lh(i,o),null,s,r,n)}if(e instanceof ou){s=e.key.path.L(),e=Lc(e.version);return new dh(new ph(s,e),null,null,!0,r,n)}return kr()}function kc(t){t=t.v();return[t.seconds,t.nanoseconds]}function Pc(t){t=new ni(t[0],t[1]);return ri.V(t)}function Lc(t){t=t.v();return new rh(t.seconds,t.nanoseconds)}function Rc(t){t=new ni(t.seconds,t.nanoseconds);return ri.V(t)}function Vc(e,t){var n=(t.baseMutations||[]).map(function(t){return Yo(e.Co,t)}),r=t.mutations.map(function(t){return Yo(e.Co,t)}),i=ni.fromMillis(t.localWriteTimeMs);return new Ja(t.batchId,i,n,r)}function Cc(t){var e=Rc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Rc(t.lastLimboFreeSnapshotVersion):ri.min(),r=void 0!==t.query.documents?(Pr(1===(r=t.query).documents.length),mu(fu(zo(r.documents[0])))):$o(t.query);return new Ai(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Ur.fromBase64String(t.resumeToken))}function Mc(t,e){var n=Lc(e.nt),r=Lc(e.lastLimboFreeSnapshotVersion),i=(Ei(e.target)?Qo:Jo)(t.Co,e.target),t=e.resumeToken.toBase64();return new vh(e.targetId,bi(e.target),n,t,e.sequenceNumber,r,i)}var Uc=(jc.Fo=function(t,e,n,r){return Pr(""!==t.uid),new jc(t.Zs()?t.uid:"",e,n,r)},jc.prototype.ko=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gc(t).rs({index:ch.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},jc.prototype.Oo=function(d,y,v,g){var m=this,w=Bc(d),b=Gc(d);return b.add({}).next(function(t){Pr("number"==typeof t);for(var e,n,r,i,o,s=new Ja(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Xo(e.Co,t)}),o=r.mutations.map(function(t){return Xo(e.Co,t)}),new ch(n,r.batchId,r.ar.toMillis(),i,o)),a=[],c=new Ci(function(t,e){return Vr(t.B(),e.B())}),h=0,f=g;h<f.length;h++){var l=f[h],p=hh.key(m.userId,l.key.path,t),c=c.add(l.key.path.F());a.push(b.put(u)),a.push(w.put(p,hh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Dr.Mo(d,t))}),d.pr(function(){m.xo[t]=s.keys()}),sa.kn(a).next(function(){return s})})},jc.prototype.$o=function(t,e){var n=this;return Gc(t).get(e).next(function(t){return t?(Pr(t.userId===n.userId),Vc(n.serializer,t)):null})},jc.prototype.Lo=function(t,e){var n=this;return this.xo[e]?sa.resolve(this.xo[e]):this.$o(t,e).next(function(t){if(t){t=t.keys();return n.xo[e]=t}return null})},jc.prototype.Bo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Gc(t).rs({index:ch.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Pr(e.batchId>=i),o=Vc(r.serializer,e)),n.done()}).next(function(){return o})},jc.prototype.qo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Gc(t).rs({index:ch.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},jc.prototype.Uo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Gc(t).ts(ch.userMutationsIndex,n).next(function(t){return t.map(function(t){return Vc(e.serializer,t)})})},jc.prototype.Nr=function(o,s){var u=this,t=hh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Bc(o).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Sc(i);if(r===u.userId&&s.path.isEqual(i))return Gc(o).get(t).next(function(t){if(!t)throw kr();Pr(t.userId===u.userId),a.push(Vc(u.serializer,t))});n.done()}).next(function(){return a})},jc.prototype.$r=function(e,t){var s=this,u=new Ci(Vr),n=[];return t.forEach(function(o){var t=hh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Bc(e).rs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Sc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),sa.kn(n).next(function(){return s.Ko(e,u)})},jc.prototype.Qr=function(t,e){var o=this,s=e.path,u=s.length+1,e=hh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new Ci(Vr);return Bc(t).rs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Sc(i);r===o.userId&&s.M(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ko(t,a)})},jc.prototype.Ko=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Gc(e).get(t).next(function(t){if(null===t)throw kr();Pr(t.userId===n.userId),r.push(Vc(n.serializer,t))}))}),sa.kn(i).next(function(){return r})},jc.prototype.Qo=function(e,n){var r=this;return Fc(e.Wo,this.userId,n).next(function(t){return e.pr(function(){r.jo(n.batchId)}),sa.forEach(t,function(t){return r.No.Go(e,t)})})},jc.prototype.jo=function(t){delete this.xo[t]},jc.prototype.zo=function(e){var i=this;return this.ko(e).next(function(t){if(!t)return sa.resolve();var t=IDBKeyRange.lowerBound(hh.prefixForUser(i.userId)),r=[];return Bc(e).rs({range:t},function(t,e,n){t[0]===i.userId?(t=Sc(t[1]),r.push(t)):n.done()}).next(function(){Pr(0===r.length)})})},jc.prototype.Ho=function(t,e){return qc(t,this.userId,e)},jc.prototype.Jo=function(t){var e=this;return zc(t).get(this.userId).next(function(t){return t||new ah(e.userId,-1,"")})},jc);function jc(t,e,n,r){this.userId=t,this.serializer=e,this.Dr=n,this.No=r,this.xo={}}function qc(t,o,e){var e=hh.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Bc(t).rs({range:e,ss:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Fc(t,e,n){var r=t.store(ch.store),i=t.store(hh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.rs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Pr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=hh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return sa.kn(o).next(function(){return u})}function Gc(t){return Ch.Kn(t,ch.store)}function Bc(t){return Ch.Kn(t,hh.store)}function zc(t){return Ch.Kn(t,ah.store)}var Hc,Kc=(Yc.prototype.Ir=function(t,e,n){return Jc(t).put($c(e),n)},Yc.prototype.Ar=function(t,e){t=Jc(t),e=$c(e);return t.delete(e)},Yc.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},Yc.prototype.Rr=function(t,e){var n=this;return Jc(t).get($c(e)).next(function(t){return n.Xo(t)})},Yc.prototype.Zo=function(t,e){var n=this;return Jc(t).get($c(e)).next(function(t){var e=n.Xo(t);return e?{ta:e,size:Zc(t)}:null})},Yc.prototype.getEntries=function(t,e){var n=this,r=Ui;return this.ea(t,e,function(t,e){e=n.Xo(e);r=r.ot(t,e)}).next(function(){return r})},Yc.prototype.na=function(t,e){var r=this,i=Ui,o=new xi(ui.D);return this.ea(t,e,function(t,e){var n=r.Xo(e);o=n?(i=i.ot(t,n),o.ot(t,Zc(e))):(i=i.ot(t,null),o.ot(t,0))}).next(function(){return{sa:i,ia:o}})},Yc.prototype.ea=function(t,e,i){if(e.P())return sa.resolve();var n=IDBKeyRange.bound(e.first().path.L(),e.last().path.L()),o=e._t(),s=o.It();return Jc(t).rs({range:n},function(t,e,n){for(var r=ui.Z(t);s&&ui.D(s,r)<0;)i(s,null),s=o.It();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.It():null),s?n.Xn(s.path.L()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.It():null})},Yc.prototype.Lr=function(t,r,e){var n,i=this,o=Fi,s=r.path.length+1,u={};return e.isEqual(ri.min())?(n=r.path.L(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.L(),e=kc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=dh.collectionReadTimeIndex),Jc(t).rs(u,function(t,e,n){t.length===s&&(e=xc(i.serializer,e),r.path.M(e.key.path)?e instanceof ru&&Au(r,e)&&(o=o.ot(e.key,e)):n.done())}).next(function(){return o})},Yc.prototype.ra=function(t){return new Wc(this,!!t&&t.oa)},Yc.prototype.aa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Yc.prototype.getMetadata=function(t){return Qc(t).get(yh.key).next(function(t){return Pr(!!t),t})},Yc.prototype.Yo=function(t,e){return Qc(t).put(yh.key,e)},Yc.prototype.Xo=function(t){if(t){t=xc(this.serializer,t);return t instanceof iu&&t.version.isEqual(ri.min())?null:t}return null},Yc),Wc=(n(Xc,Hc=h),Xc.prototype.Vr=function(i){var o=this,s=[],u=0,a=new Ci(function(t,e){return Vr(t.B(),e.B())});return this.wr.forEach(function(t,e){var n,r=o.ca.get(t);e?(n=Oc(o.ha.serializer,e,o.readTime),a=a.add(t.path.F()),e=Zc(n),u+=e-r,s.push(o.ha.Ir(i,t,n))):(u-=r,o.oa?(r=Oc(o.ha.serializer,new iu(t,ri.min()),o.readTime),s.push(o.ha.Ir(i,t,r))):s.push(o.ha.Ar(i,t)))}),a.forEach(function(t){s.push(o.ha.Dr.Mo(i,t))}),s.push(this.ha.updateMetadata(i,u)),sa.kn(s)},Xc.prototype.Pr=function(t,e){var n=this;return this.ha.Zo(t,e).next(function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.ta)})},Xc.prototype.gr=function(t,e){var n=this;return this.ha.na(t,e).next(function(t){var e=t.sa;return t.ia.forEach(function(t,e){n.ca.set(t,e)}),e})},Xc);function Xc(t,e){var n=this;return(n=Hc.call(this)||this).ha=t,n.oa=e,n.ca=new ei(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Yc(t,e){this.serializer=t,this.Dr=e}function Qc(t){return Ch.Kn(t,yh.store)}function Jc(t){return Ch.Kn(t,dh.store)}function $c(t){return t.path.L()}function Zc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}var th=(uh.prototype.Mo=function(t,e){return this.ua.add(e),sa.resolve()},uh.prototype.Kr=function(t,e){return sa.resolve(this.ua.getEntries(e))},uh),eh=(sh.prototype.add=function(t){var e=t.O(),n=t.F(),r=this.index[e]||new Ci(ii.D),t=!r.has(n);return this.index[e]=r.add(n),t},sh.prototype.has=function(t){var e=t.O(),t=t.F(),e=this.index[e];return e&&e.has(t)},sh.prototype.getEntries=function(t){return(this.index[t]||new Ci(ii.D)).L()},sh),nh=(oh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Pr(t<r&&0<=t&&r<=10);var o=new va("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(ih.store),(s=e).createObjectStore(ah.store,{keyPath:ah.keyPath}),s.createObjectStore(ch.store,{keyPath:ch.keyPath,autoIncrement:!0}).createIndex(ch.userMutationsIndex,ch.userMutationsKeyPath,{unique:!0}),s.createObjectStore(hh.store),bh(e),e.createObjectStore(dh.store));var s,u=sa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(gh.store),s.deleteObjectStore(vh.store),s.deleteObjectStore(mh.store),bh(e)),u=u.next(function(){return t=o.store(mh.store),e=new mh(0,0,ri.min().v(),0),t.put(mh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(ch.store).ts().next(function(t){n.deleteObjectStore(ch.store),n.createObjectStore(ch.store,{keyPath:ch.keyPath,autoIncrement:!0}).createIndex(ch.userMutationsIndex,ch.userMutationsKeyPath,{unique:!0});var e=r.store(ch.store),t=t.map(function(t){return e.put(t)});return sa.kn(t)});var n,r})),u=u.next(function(){e.createObjectStore(Ih.store,{keyPath:Ih.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(yh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(dh.store)).createIndex(dh.readTimeIndex,dh.readTimeIndexPath,{unique:!1}),t.createIndex(dh.collectionReadTimeIndex,dh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},oh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(dh.store).rs(function(t,e){n+=Zc(e)}).next(function(){var t=new yh(n);return e.store(yh.store).put(yh.key,t)})},oh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(ah.store),i=n.store(ch.store);return t.ts().next(function(t){return sa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.ts(ch.userMutationsIndex,t).next(function(t){return sa.forEach(t,function(t){Pr(t.userId===e.userId);t=Vc(r.serializer,t);return Fc(n,e.userId,t).next(function(){})})})})})},oh.prototype.ensureSequenceNumbers=function(t){var o=t.store(gh.store),e=t.store(dh.store);return t.store(mh.store).get(mh.key).next(function(r){var i=[];return e.rs(function(t,e){var n=new ii(t),t=[0,Ac(n)];i.push(o.get(t).next(function(t){return t?sa.resolve():o.put(new gh(0,Ac(n),r.highestListenSequenceNumber))}))}).next(function(){return sa.kn(i)})})},oh.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(wh.store,{keyPath:wh.keyPath});function r(t){if(i.add(t)){var e=t.O(),t=t.F();return n.put({collectionId:e,parent:Ac(t)})}}var n=e.store(wh.store),i=new eh;return e.store(dh.store).rs({ss:!0},function(t,e){t=new ii(t);return r(t.F())}).next(function(){return e.store(hh.store).rs({ss:!0},function(t,e){t[0];var n=t[1],n=(t[2],Sc(n));return r(n.F())})})},oh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(vh.store);return r.rs(function(t,e){e=Cc(e),e=Mc(n.serializer,e);return r.put(e)})},oh),rh=function(t,e){this.seconds=t,this.nanoseconds=e},ih=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function oh(t){this.serializer=t}function sh(){this.index={}}function uh(){this.ua=new eh}ih.store="owner",ih.key="owner";var ah=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};ah.store="mutationQueues",ah.keyPath="userId";var ch=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ch.store="mutations",ch.keyPath="batchId",ch.userMutationsIndex="userMutationsIndex",ch.userMutationsKeyPath=["userId","batchId"];var hh=(fh.prefixForUser=function(t){return[t]},fh.prefixForPath=function(t,e){return[t,Ac(e)]},fh.key=function(t,e,n){return[t,Ac(e),n]},fh);function fh(){}hh.store="documentMutations",hh.PLACEHOLDER=new hh;var lh=function(t,e){this.path=t,this.readTime=e},ph=function(t,e){this.path=t,this.version=e},dh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};dh.store="remoteDocuments",dh.readTimeIndex="readTimeIndex",dh.readTimeIndexPath="readTime",dh.collectionReadTimeIndex="collectionReadTimeIndex",dh.collectionReadTimeIndexPath=["parentPath","readTime"];var yh=function(t){this.byteSize=t};yh.store="remoteDocumentGlobal",yh.key="remoteDocumentGlobalKey";var vh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};vh.store="targets",vh.keyPath="targetId",vh.queryTargetsIndexName="queryTargetsIndex",vh.queryTargetsKeyPath=["canonicalId","targetId"];var gh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};gh.store="targetDocuments",gh.keyPath=["targetId","path"],gh.documentTargetsIndex="documentTargetsIndex",gh.documentTargetsKeyPath=["path","targetId"];var mh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};mh.key="targetGlobalKey",mh.store="targetGlobal";var wh=function(t,e){this.collectionId=t,this.parent=e};function bh(t){t.createObjectStore(gh.store,{keyPath:gh.keyPath}).createIndex(gh.documentTargetsIndex,gh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(vh.store,{keyPath:vh.keyPath}).createIndex(vh.queryTargetsIndexName,vh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(mh.store)}wh.store="collectionParents",wh.keyPath=["collectionId","parent"];var Ih=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ih.store="clientMetadata",Ih.keyPath="clientId";var Eh=i(i(i([ah.store,ch.store,hh.store,dh.store,vh.store,ih.store,mh.store,gh.store],[Ih.store]),[yh.store]),[wh.store]),_h=(Th.prototype.Mo=function(t,e){var n=this;if(this.la.has(e))return sa.resolve();var r=e.O(),i=e.F();t.pr(function(){n.la.add(e)});i={collectionId:r,parent:Ac(i)};return Ah(t).put(i)},Th.prototype.Kr=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Mr(i),""],!1,!0);return Ah(t).ts(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Sc(r.parent))}return o})},Th);function Th(){this.la=new eh}function Ah(t){return Ch.Kn(t,wh.store)}var Nh=(xh.prototype.next=function(){return this._a+=2,this._a},xh.fa=function(){return new xh(0)},xh.da=function(){return new xh(-1)},xh),Sh=(Dh.prototype.wa=function(n){var r=this;return this.Ea(n).next(function(t){var e=new Nh(t.highestTargetId);return t.highestTargetId=e.next(),r.Ta(n,t).next(function(){return t.highestTargetId})})},Dh.prototype.Ia=function(t){return this.Ea(t).next(function(t){return ri.V(new ni(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Dh.prototype.ma=function(t){return this.Ea(t).next(function(t){return t.highestListenSequenceNumber})},Dh.prototype.Aa=function(e,n,r){var i=this;return this.Ea(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.v()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ta(e,t)})},Dh.prototype.Ra=function(e,n){var r=this;return this.Pa(e,n).next(function(){return r.Ea(e).next(function(t){return t.targetCount+=1,r.ga(n,t),r.Ta(e,t)})})},Dh.prototype.Va=function(t,e){return this.Pa(t,e)},Dh.prototype.ya=function(e,t){var n=this;return this.pa(e,t.targetId).next(function(){return Oh(e).delete(t.targetId)}).next(function(){return n.Ea(e)}).next(function(t){return Pr(0<t.targetCount),--t.targetCount,n.Ta(e,t)})},Dh.prototype.po=function(n,r,i){var o=this,s=0,u=[];return Oh(n).rs(function(t,e){e=Cc(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ya(n,e)))}).next(function(){return sa.kn(u)}).next(function(){return s})},Dh.prototype.Ce=function(t,n){return Oh(t).rs(function(t,e){e=Cc(e);n(e)})},Dh.prototype.Ea=function(t){return kh(t).get(mh.key).next(function(t){return Pr(null!==t),t})},Dh.prototype.Ta=function(t,e){return kh(t).put(mh.key,e)},Dh.prototype.Pa=function(t,e){return Oh(t).put(Mc(this.serializer,e))},Dh.prototype.ga=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Dh.prototype.ba=function(t){return this.Ea(t).next(function(t){return t.targetCount})},Dh.prototype.va=function(t,r){var e=bi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Oh(t).rs({range:e,index:vh.queryTargetsIndexName},function(t,e,n){e=Cc(e);Ii(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Dh.prototype.Sa=function(n,t,r){var i=this,o=[],s=Ph(n);return t.forEach(function(t){var e=Ac(t.path);o.push(s.put(new gh(r,e))),o.push(i.No.Da(n,r,t))}),sa.kn(o)},Dh.prototype.Ca=function(n,t,r){var i=this,o=Ph(n);return sa.forEach(t,function(t){var e=Ac(t.path);return sa.kn([o.delete([r,e]),i.No.Na(n,r,t)])})},Dh.prototype.pa=function(t,e){t=Ph(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},Dh.prototype.xa=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Ph(t),r=zi();return t.rs({range:e,ss:!0},function(t,e,n){t=Sc(t[1]),t=new ui(t);r=r.add(t)}).next(function(){return r})},Dh.prototype.Ho=function(t,e){var e=Ac(e.path),e=IDBKeyRange.bound([e],[Mr(e)],!1,!0),i=0;return Ph(t).rs({index:gh.documentTargetsIndex,ss:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Dh.prototype.Ue=function(t,e){return Oh(t).get(e).next(function(t){return t?Cc(t):null})},Dh);function Dh(t,e){this.No=t,this.serializer=e}function xh(t){this._a=t}function Oh(t){return Ch.Kn(t,vh.store)}function kh(t){return Ch.Kn(t,mh.store)}function Ph(t){return Ch.Kn(t,gh.store)}var Lh,Rh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Vh=(n(Uh,Lh=Ie),Uh),Ch=(Mh.Kn=function(t,e){if(t instanceof Vh)return ua.Kn(t.Wo,e);throw kr()},Mh.prototype.start=function(){var e=this;return this.za().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Er.FAILED_PRECONDITION,Rh);return e.Ha(),e.Ja(),e.Ya(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ja.ma(t)})}).then(function(t){e.Ma=new ja(t,e.ka)}).then(function(){e.$a=!0}).catch(function(t){return e.Wa&&e.Wa.close(),Promise.reject(t)})},Mh.prototype.Xa=function(n){var t=this;return this.Ka=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ii?[2,n(e)]:[2]})})},n(this.isPrimary)},Mh.prototype.Za=function(n){var t=this;this.Wa.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Mh.prototype.th=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.fn.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ii?[4,this.za()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Mh.prototype.za=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return qh(e).put(new Ih(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.eh(e).next(function(t){t||(n.isPrimary=!1,n.fn.Cs(function(){return n.Ka(!1)}))})}).next(function(){return n.nh(e)}).next(function(t){return n.isPrimary&&!t?n.sh(e).next(function(){return!1}):!!t&&n.ih(e).next(function(){return!0})})}).catch(function(t){if(ya(t))return Sr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Sr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.fn.Cs(function(){return n.Ka(t)}),n.isPrimary=t})},Mh.prototype.eh=function(t){var e=this;return jh(t).get(ih.key).next(function(t){return sa.resolve(e.rh(t))})},Mh.prototype.oh=function(t){return qh(t).delete(this.clientId)},Mh.prototype.ah=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.hh(this.Ua,18e5)?[3,2]:(this.Ua=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Mh.Kn(t,Ih.store);return r.ts().next(function(t){var e=o.uh(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return sa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ga)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ga.removeItem(this.lh(i.clientId));t.label=2;case 2:return[2]}})})},Mh.prototype.Ya=function(){var t=this;this.qa=this.fn.Vn("client_metadata_refresh",4e3,function(){return t.za().then(function(){return t.ah()}).then(function(){return t.Ya()})})},Mh.prototype.rh=function(t){return!!t&&t.ownerId===this.clientId},Mh.prototype.nh=function(e){var r=this;return this.Oa?sa.resolve(!0):jh(e).get(ih.key).next(function(t){if(null!==t&&r.hh(t.leaseTimestampMs,5e3)&&!r._h(t.ownerId)){if(r.rh(t)&&r.networkEnabled)return!0;if(!r.rh(t)){if(!t.allowTabSynchronization)throw new _r(Er.FAILED_PRECONDITION,Rh);return!1}}return!(!r.networkEnabled||!r.inForeground)||qh(e).ts().next(function(t){return void 0===r.uh(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Sr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Mh.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.$a=!1,this.fh(),this.qa&&(this.qa.cancel(),this.qa=null),this.dh(),this.wh(),[4,this.Wa.runTransaction("shutdown","readwrite",[ih.store,Ih.store],function(t){var e=new Vh(t,ja.ai);return n.sh(e).next(function(){return n.oh(e)})})];case 1:return t.sent(),this.Wa.close(),this.Eh(),[2]}})})},Mh.prototype.uh=function(t,e){var n=this;return t.filter(function(t){return n.hh(t.updateTimeMs,e)&&!n._h(t.clientId)})},Mh.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return qh(t).ts().next(function(t){return e.uh(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Mh.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Mh.prototype.Th=function(t){return Uc.Fo(t,this.serializer,this.Dr,this.No)},Mh.prototype.Ih=function(){return this.ja},Mh.prototype.mh=function(){return this.vr},Mh.prototype.Ah=function(){return this.Dr},Mh.prototype.runTransaction=function(e,n,r){var i=this;Sr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wa.runTransaction(e,t,Eh,function(t){return o=new Vh(t,i.Ma?i.Ma.next():ja.ai),"readwrite-primary"===n?i.eh(o).next(function(t){return!!t||i.nh(o)}).next(function(t){if(!t)throw Dr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.fn.Cs(function(){return i.Ka(!1)}),new _r(Er.FAILED_PRECONDITION,Za);return r(o)}).next(function(t){return i.ih(o).next(function(){return t})}):i.Rh(o).next(function(){return r(o)})}).then(function(t){return o.br(),t})},Mh.prototype.Rh=function(t){var e=this;return jh(t).get(ih.key).next(function(t){if(null!==t&&e.hh(t.leaseTimestampMs,5e3)&&!e._h(t.ownerId)&&!e.rh(t)&&!(e.Oa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Er.FAILED_PRECONDITION,Rh)})},Mh.prototype.ih=function(t){var e=new ih(this.clientId,this.allowTabSynchronization,Date.now());return jh(t).put(ih.key,e)},Mh.Ln=function(){return ua.Ln()},Mh.prototype.sh=function(t){var e=this,n=jh(t);return n.get(ih.key).next(function(t){return e.rh(t)?(Sr("IndexedDbPersistence","Releasing primary lease."),n.delete(ih.key)):sa.resolve()})},Mh.prototype.hh=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},Mh.prototype.Ha=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ba=function(){t.fn.ws(function(){return t.inForeground="visible"===t.document.visibilityState,t.za()})},this.document.addEventListener("visibilitychange",this.Ba),this.inForeground="visible"===this.document.visibilityState)},Mh.prototype.dh=function(){this.Ba&&(this.document.removeEventListener("visibilitychange",this.Ba),this.Ba=null)},Mh.prototype.Ja=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.La=function(){e.fh(),e.fn.ws(function(){return e.Di()})},this.window.addEventListener("unload",this.La))},Mh.prototype.wh=function(){this.La&&(this.window.removeEventListener("unload",this.La),this.La=null)},Mh.prototype._h=function(t){try{var e=null!==(null===(e=this.Ga)||void 0===e?void 0:e.getItem(this.lh(t)));return Sr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Mh.prototype.fh=function(){if(this.Ga)try{this.Ga.setItem(this.lh(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},Mh.prototype.Eh=function(){if(this.Ga)try{this.Ga.removeItem(this.lh(this.clientId))}catch(t){}},Mh.prototype.lh=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Mh);function Mh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.fn=i,this.window=o,this.document=s,this.ka=a,this.Oa=c,this.Ma=null,this.$a=!1,this.isPrimary=!1,this.networkEnabled=!0,this.La=null,this.inForeground=!1,this.Ba=null,this.qa=null,this.Ua=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!Mh.Ln())throw new _r(Er.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.No=new Fh(this,r),this.Qa=e+"main",this.serializer=new Dc(u),this.Wa=new ua(this.Qa,10,new nh(this.serializer)),this.ja=new Sh(this.No,this.serializer),this.Dr=new _h,this.vr=(e=this.serializer,u=this.Dr,new Kc(e,u)),this.window&&this.window.localStorage?this.Ga=this.window.localStorage:(this.Ga=null,!1===c&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Uh(t,e){var n=this;return(n=Lh.call(this)||this).Wo=t,n.Fa=e,n}function jh(t){return Ch.Kn(t,ih.store)}function qh(t){return Ch.Kn(t,Ih.store)}var Fh=(Gh.prototype.Po=function(t){var n=this.Ph(t);return this.db.Ih().ba(t).next(function(e){return n.next(function(t){return e+t})})},Gh.prototype.Ph=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},Gh.prototype.Ce=function(t,e){return this.db.Ih().Ce(t,e)},Gh.prototype.yo=function(t,n){return this.gh(t,function(t,e){return n(e)})},Gh.prototype.Da=function(t,e,n){return Bh(t,n)},Gh.prototype.Na=function(t,e,n){return Bh(t,n)},Gh.prototype.po=function(t,e,n){return this.db.Ih().po(t,e,n)},Gh.prototype.Go=Bh,Gh.prototype.Vh=function(t,e){return r=e,i=!1,zc(n=t).os(function(t){return qc(n,t,r).next(function(t){return t&&(i=!0),sa.resolve(!t)})}).next(function(){return i});var n,r,i},Gh.prototype.bo=function(n,r){var i=this,o=this.db.mh().ra(),s=[],u=0;return this.gh(n,function(e,t){t<=r&&(t=i.Vh(n,e).next(function(t){if(!t)return u++,o.Rr(n,e).next(function(){return o.Ar(e),Ph(n).delete([0,Ac(e.path)])})}),s.push(t))}).next(function(){return sa.kn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Gh.prototype.removeTarget=function(t,e){e=e.st(t.Fa);return this.db.Ih().Va(t,e)},Gh.prototype.yh=Bh,Gh.prototype.gh=function(t,r){var i,t=Ph(t),o=ja.ai;return t.rs({index:gh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ja.ai&&r(new ui(Sc(i)),o),o=e,i=t):o=ja.ai}).next(function(){o!==ja.ai&&r(new ui(Sc(i)),o)})},Gh.prototype.So=function(t){return this.db.mh().aa(t)},Gh);function Gh(t,e){this.db=t,this.wo=new Ec(this,e)}function Bh(t,e){return Ph(t).put((t=t.Fa,new gh(0,Ac(e.path),t)))}function zh(t,e){var n=t.projectId;return t.I||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Hh=(Kh.prototype.mo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.vo(t,n.bh)})},Kh);function Kh(t,e,n){this.persistence=t,this.ph=e,this.bh=new xi(Vr),this.Sh=new ei(bi,Ii),this.Dh=ri.min(),this.Sr=t.Th(n),this.Ch=t.mh(),this.ja=t.Ih(),this.Nh=new tc(this.Ch,this.Sr,this.persistence.Ah()),this.ph.xh(this.Nh)}function Wh(t,h){var f=t;return f.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=f.Ch.ra({oa:!0});return e=f,r=t,o=c,s=(i=h).batch,n=s.keys(),u=sa.resolve(),n.forEach(function(n){u=u.next(function(){return o.Rr(r,n)}).next(function(t){var e=t,t=i.dr.get(n);Pr(null!==t),(!e||e.version.h(t)<0)&&(e=s.hr(n,e,i))&&o.Ir(e,i._r)})}),u.next(function(){return e.Sr.Qo(r,s)}).next(function(){return c.apply(t)}).next(function(){return f.Sr.zo(t)}).next(function(){return f.Nh.Or(t,a)})})}function Xh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ja.Ia(t)})}function Yh(t,a){var c=t,h=a.nt,f=c.bh;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Ch.ra({oa:!0});f=c.bh;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.ja.Ca(s,t.se,e).next(function(){return c.ja.Sa(s,t.ee,e)})),0<(i=t.resumeToken).o()&&(n=o.it(i,h).st(s.Fa),f=f.ot(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.o()),(0===r.resumeToken.o()||3e8<=o.nt.p()-r.nt.p()||0<i.ee.size+i.ne.size+i.se.size)&&u.push(c.ja.Va(s,n))))});var t,o=Ui,n=zi();return a.Jt.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Jt.forEach(function(t,e){var n=r.get(t);e instanceof iu&&e.version.isEqual(ri.min())?(i.Ar(t,h),o=o.ot(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(i.Ir(e,h),o=o.ot(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(c.persistence.No.yh(s,t))})})),h.isEqual(ri.min())||(t=c.ja.Ia(s).next(function(t){return c.ja.Aa(s,s.Fa,h)}),u.push(t)),sa.kn(u).next(function(){return i.apply(s)}).next(function(){return c.Nh.Mr(s,o)})}).then(function(t){return c.bh=f,t})}function Qh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ja.va(e,r).next(function(t){return t?(n=t,sa.resolve(n)):i.ja.wa(e).next(function(t){return n=new Ai(r,t,0,e.Fa),i.ja.Ra(e,n).next(function(){return n})})})}).then(function(t){var e=i.bh.get(t.targetId);return(null===e||0<t.nt.h(e.nt))&&(i.bh=i.bh.ot(t.targetId,t),i.Sh.set(r,t.targetId)),t})}function Jh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).bh.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.No.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ya(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.bh=e.bh.remove(o),e.Sh.delete(n.target),[2]}})})}function $h(t,o,s){var u=t,a=ri.min(),c=zi();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=mu(o),(void 0!==(t=(i=t).Sh.get(r))?sa.resolve(i.bh.get(t)):i.ja.va(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ja.xa(e,t.targetId).next(function(t){c=t})}).next(function(){return u.ph.Lr(e,o,s?a:ri.min(),s?c:zi())}).next(function(t){return{documents:t,Fh:c}});var t,n,r,i})}function Zh(t,e){var n=t,r=n.ja,t=n.bh.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Ue(t,e).next(function(t){return t?t.target:null})})}function tf(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ch,n=t,t=s.Dh,r=e,i=Ui,o=kc(t),t=Jc(n),n=IDBKeyRange.lowerBound(o,!0),t.rs({index:dh.readTimeIndex,range:n},function(t,e){var n=xc(r.serializer,e);i=i.ot(n.key,n),o=e.readTime}).next(function(){return{kh:i,readTime:Pc(o)}});var e,n,r,i,o}).then(function(t){var e=t.kh,t=t.readTime;return s.Dh=t,e})}function ef(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Jc(t),r=ri.min(),t.rs({index:dh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Pc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.Dh=t})]})})}function nf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||e.message!==Za)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function rf(t,e){this.user=e,this.type="OAuth",this.Gh={},this.Gh.Authorization="Bearer "+t}function of(t,e,n,r,i){var o=this;this.Gc=t,this.zc=e,this.hs=n,this.Hc={},this.Jc=[],this.Yc=new Map,this.Xc=new Set,this.Zc=[],this.tu=i,this.tu.eu(function(t){n.ws(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return jf(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(4),[4,kf(e)];case 1:return t.sent(),e.nu.set("Unknown"),e.Xc.delete(4),[4,Of(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.nu=new mf(n,r)}var sf,uf,af,cf=(xf.prototype.P=function(){return this.Oh.P()},xf.prototype.Da=function(t,e){e=new hf(t,e);this.Oh=this.Oh.add(e),this.$h=this.$h.add(e)},xf.prototype.Bh=function(t,e){var n=this;t.forEach(function(t){return n.Da(t,e)})},xf.prototype.Na=function(t,e){this.qh(new hf(t,e))},xf.prototype.Uh=function(t,e){var n=this;t.forEach(function(t){return n.Na(t,e)})},xf.prototype.Kh=function(t){var e=this,n=new ui(new ii([])),r=new hf(n,t),t=new hf(n,t+1),i=[];return this.$h.xt([r,t],function(t){e.qh(t),i.push(t.key)}),i},xf.prototype.Qh=function(){var e=this;this.Oh.forEach(function(t){return e.qh(t)})},xf.prototype.qh=function(t){this.Oh=this.Oh.delete(t),this.$h=this.$h.delete(t)},xf.prototype.Wh=function(t){var e=new ui(new ii([])),n=new hf(e,t),t=new hf(e,t+1),r=zi();return this.$h.xt([n,t],function(t){r=r.add(t.key)}),r},xf.prototype.Ho=function(t){var e=new hf(t,0),e=this.Oh.kt(e);return null!==e&&t.isEqual(e.key)},xf),hf=(Df.Mh=function(t,e){return ui.D(t.key,e.key)||Vr(t.jh,e.jh)},Df.Lh=function(t,e){return Vr(t.jh,e.jh)||ui.D(t.key,e.key)},Df),ff=(Sf.prototype.getToken=function(){return Promise.resolve(null)},Sf.prototype.Hh=function(){},Sf.prototype.Jh=function(t){(this.zh=t)(Ca.UNAUTHENTICATED)},Sf.prototype.Yh=function(){this.zh=null},Sf),lf=(Nf.prototype.getToken=function(){var e=this,n=this.tc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.tc!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new rf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Nf.prototype.Hh=function(){this.forceRefresh=!0},Nf.prototype.Jh=function(t){this.zh=t,this.Zh&&t(this.currentUser)},Nf.prototype.Yh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Xh),this.Xh=null,this.zh=null},Nf.prototype.ec=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new Ca(t)},Nf),pf=(Object.defineProperty(Af.prototype,"Gh",{get:function(){var t={"X-Goog-AuthUser":this.sc},e=this.nc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Af),df=(Tf.prototype.getToken=function(){return Promise.resolve(new pf(this.nc,this.sc))},Tf.prototype.Jh=function(t){t(Ca.ni)},Tf.prototype.Yh=function(){},Tf.prototype.Hh=function(){},Tf),Ee=(_f.prototype.cc=function(){return 1===this.state||2===this.state||4===this.state},_f.prototype.uc=function(){return 2===this.state},_f.prototype.start=function(){3!==this.state?this.auth():this.lc()},_f.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.cc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},_f.prototype._c=function(){this.state=0,this.Vs.reset()},_f.prototype.fc=function(){var t=this;this.uc()&&null===this.hc&&(this.hc=this.fn.Vn(this.ic,6e4,function(){return t.dc()}))},_f.prototype.wc=function(t){this.Ec(),this.stream.send(t)},_f.prototype.dc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.uc()?[2,this.close(0)]:[2]})})},_f.prototype.Ec=function(){this.hc&&(this.hc.cancel(),this.hc=null)},_f.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ec(),this.Vs.cancel(),this.ac++,3!==e?this.Vs.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Vs.Rn()):n&&n.code===Er.UNAUTHENTICATED&&this.oc.Hh(),null!==this.stream&&(this.Tc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ic(n)];case 1:return t.sent(),[2]}})})},_f.prototype.Tc=function(){},_f.prototype.auth=function(){var n=this;this.state=1;var t=this.mc(this.ac),e=this.ac;this.oc.getToken().then(function(t){n.ac===e&&n.Ac(t)},function(e){t(function(){var t=new _r(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Rc(t)})})},_f.prototype.Ac=function(t){var e=this,n=this.mc(this.ac);this.stream=this.Pc(t),this.stream.gc(function(){n(function(){return e.state=2,e.listener.gc()})}),this.stream.Ic(function(t){n(function(){return e.Rc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},_f.prototype.lc=function(){var t=this;this.state=4,this.Vs.Pn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},_f.prototype.Rc=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},_f.prototype.mc=function(e){var n=this;return function(t){n.fn.ws(function(){return n.ac===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},_f),yf=(n(Ef,af=Ee),Ef.prototype.Pc=function(t){return this.rc.Vc("Listen",t)},Ef.prototype.onMessage=function(t){this.Vs.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:kr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ke?(Pr(void 0===o||"string"==typeof o),Ur.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),Ur.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:Di(s.code),new _r(o,s.message||"")),r=new Zi(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=Go(t,u.document.name),a=Uo(u.document.updateTime),s=new Xs({mapValue:{fields:u.document.fields}}),a=new ru(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new Ji(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=Go(t,u.document),c=u.readTime?Uo(u.readTime):ri.min(),c=new iu(a,c),u=u.removedTargetIds||[];r=new Ji([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=Go(t,c.document),c=c.removedTargetIds||[];r=new Ji([],c,h,null)}else{if(!("filter"in e))return kr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new _i(e),h=h.targetId;r=new $i(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return ri.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?Uo(t.readTime):ri.min()}(t);return this.listener.yc(e,t)},Ef.prototype.bc=function(t){var e,n,r,i={};i.database=Ho(this.serializer),i.addTarget=(e=this.serializer,(r=Ei(r=(n=t).target)?{documents:Qo(e,r)}:{query:Jo(e,r)}).targetId=n.targetId,0<n.resumeToken.o()&&(r.resumeToken=Mo(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.et){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.wc(i)},Ef.prototype.vc=function(t){var e={};e.database=Ho(this.serializer),e.removeTarget=t,this.wc(e)},Ef),vf=(n(If,uf=Ee),Object.defineProperty(If.prototype,"Dc",{get:function(){return this.Sc},enumerable:!1,configurable:!0}),If.prototype.start=function(){this.Sc=!1,this.lastStreamToken=void 0,uf.prototype.start.call(this)},If.prototype.Tc=function(){this.Sc&&this.Cc([])},If.prototype.Pc=function(t){return this.rc.Vc("Write",t)},If.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Sc){this.Vs.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual(ri.min())&&(n=Uo(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new As(n,e)}(t,r)})):[]),n=Uo(t.commitTime);return this.listener.Nc(n,e)}var n,r;return Pr(!t.writeResults||0===t.writeResults.length),this.Sc=!0,this.listener.xc()},If.prototype.Fc=function(){var t={};t.database=Ho(this.serializer),this.wc(t)},If.prototype.Cc=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Xo(e.serializer,t)})};this.wc(t)},If),gf=(n(bf,sf=function(){}),bf.prototype.Oc=function(){if(this.kc)throw new _r(Er.FAILED_PRECONDITION,"The client has already been terminated.")},bf.prototype.Mc=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.Mc(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Hh(),t})},bf.prototype.$c=function(e,n,r){var i=this;return this.Oc(),this.credentials.getToken().then(function(t){return i.rc.$c(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Hh(),t})},bf.prototype.terminate=function(){this.kc=!1},bf),mf=(wf.prototype.Uc=function(){var t=this;0===this.Lc&&(this.Kc("Unknown"),this.Bc=this.hs.Vn("online_state_timeout",1e4,function(){return t.Bc=null,t.Qc("Backend didn't respond within 10 seconds."),t.Kc("Offline"),Promise.resolve()}))},wf.prototype.Wc=function(t){"Online"===this.state?this.Kc("Unknown"):(this.Lc++,1<=this.Lc&&(this.jc(),this.Qc("Connection failed 1 times. Most recent error: "+t.toString()),this.Kc("Offline")))},wf.prototype.set=function(t){this.jc(),this.Lc=0,"Online"===t&&(this.qc=!1),this.Kc(t)},wf.prototype.Kc=function(t){t!==this.state&&(this.state=t,this.di(t))},wf.prototype.Qc=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qc?(Dr(t),this.qc=!1):Sr("OnlineStateTracker",t)},wf.prototype.jc=function(){null!==this.Bc&&(this.Bc.cancel(),this.Bc=null)},wf);function wf(t,e){this.hs=t,this.di=e,this.state="Unknown",this.Lc=0,this.Bc=null,this.qc=!0}function bf(t,e,n){var r=this;return(r=sf.call(this)||this).credentials=t,r.rc=e,r.serializer=n,r.kc=!1,r}function If(t,e,n,r,i){var o=this;return(o=uf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Sc=!1,o}function Ef(t,e,n,r,i){var o=this;return(o=af.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function _f(t,e,n,r,i,o){this.fn=t,this.ic=n,this.rc=r,this.oc=i,this.listener=o,this.state=0,this.ac=0,this.hc=null,this.stream=null,this.Vs=new oa(t,e)}function Tf(t,e){this.nc=t,this.sc=e}function Af(t,e){this.nc=t,this.sc=e,this.type="FirstParty",this.user=Ca.ni}function Nf(t){var e=this;this.Xh=null,this.currentUser=Ca.UNAUTHENTICATED,this.Zh=!1,this.tc=0,this.zh=null,this.forceRefresh=!1,this.Xh=function(){e.tc++,e.currentUser=e.ec(),e.Zh=!0,e.zh&&e.zh(e.currentUser)},this.tc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Xh):(this.Xh(null),t.get().then(function(t){e.auth=t,e.Xh&&e.auth.addAuthTokenListener(e.Xh)},function(){}))}function Sf(){this.zh=null}function Df(t,e){this.key=t,this.jh=e}function xf(){this.Oh=new Ci(hf.Mh),this.$h=new Ci(hf.Lh)}function Of(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!jf(r))return[3,4];e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function kf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Zc,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Pf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Xc.add(5),[4,kf(e)];case 1:return t.sent(),e.tu.Di(),e.nu.set("Unknown"),[2]}})})}function Lf(t,e){t.Yc.has(e.targetId)||(t.Yc.set(e.targetId,e),Uf(t)?Mf(t):Xf(t).uc()&&Vf(t,e))}function Rf(t,e){var n=t,t=Xf(n);n.Yc.delete(e),t.uc()&&Cf(n,e),0===n.Yc.size&&(t.uc()?t.fc():jf(n)&&n.nu.set("Unknown"))}function Vf(t,e){t.su.me(e.targetId),Xf(t).bc(e)}function Cf(t,e){t.su.me(e),Xf(t).vc(e)}function Mf(e){e.su=new eo({qe:function(t){return e.Hc.qe(t)},Ue:function(t){return e.Yc.get(t)||null}}),Xf(e).start(),e.nu.Uc()}function Uf(t){return jf(t)&&!Xf(t).cc()&&0<t.Yc.size}function jf(t){return 0===t.Xc.size}function qf(t){t.su=void 0}function Ff(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.nu.set("Online"),!(u instanceof Zi&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Yc.has(i)?[4,o.Hc.iu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Yc.delete(i),o.su.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Gf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ji?s.su.be(u):u instanceof $i?s.su.ke(u):s.su.De(u),a.isEqual(ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Xh(s.Gc)];case 8:return o=t.sent(),0<=a.h(o)?[4,(i=a,(e=(r=s).su.$e(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.o()&&((n=r.Yc.get(e))&&r.Yc.set(e,n.it(t.resumeToken,i)))}),e.Ht.forEach(function(t){var e=r.Yc.get(t);e&&(r.Yc.set(t,e.it(Ur.u,e.nt)),Cf(r,t),e=new Ai(e.target,t,1,e.sequenceNumber),Vf(r,e))}),r.Hc.ru(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Gf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Gf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ya(r))throw r;return n.Xc.add(1),[4,kf(n)];case 1:return t.sent(),n.nu.set("Offline"),i=i||function(){return Xh(n.Gc)},n.hs.Cs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Xc.delete(1),[4,Of(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Bf(e,n){return n().catch(function(t){return Gf(e,t,n)})}function zf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Yf(i=a),s=0<i.Jc.length?i.Jc[i.Jc.length-1].batchId:-1,t.label=1;case 1:if(!(jf(i)&&i.Jc.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Gc,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Sr.Bo(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Jc.length&&o.fc(),[3,7]):(s=u.batchId,function(t,e){t.Jc.push(e);t=Yf(t);t.uc()&&t.Dc&&t.Cc(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Gf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Hf(i)&&Kf(i),[2]}var e,n,r})})}function Hf(t){return jf(t)&&!Yf(t).cc()&&0<t.Jc.length}function Kf(t){Yf(t).start()}function Wf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Xc.delete(2),[4,Of(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Xc.add(2),[4,kf(e)]);case 3:t.sent(),e.nu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Xf(n){var t,e,r,i=this;return n.hu||(n.hu=(t=n.zc,e=n.hs,r={gc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Yc.forEach(function(t,e){Vf(n,t)}),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return qf(e),Uf(e)?(e.nu.Wc(n),Mf(e)):e.nu.set("Unknown"),[2]})})}.bind(null,n),yc:Ff.bind(null,n)},t.Oc(),new yf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.hu._c(),Uf(n)?Mf(n):n.nu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.hu.stop()];case 2:t.sent(),qf(n),t.label=3;case 3:return[2]}})})})),n.hu}function Yf(n){var t,e,r,i=this;return n.cu||(n.cu=(t=n.zc,e=n.hs,r={gc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Yf(e).Fc(),[2]})})}.bind(null,n),Ic:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Yf(e).Dc?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Er.ABORTED?(e=r.Jc.shift(),Yf(r)._c(),[4,Bf(r,function(){return r.Hc.au(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,zf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Hf(e)&&Kf(e),[2]}})})}.bind(null,n),xc:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Yf(o),n=0,r=o.Jc;n<r.length;n++)i=r[n],e.Cc(i.mutations);return[2]})})}.bind(null,n),Nc:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Jc.shift(),n=$a.from(e,i,o),[4,Bf(r,function(){return r.Hc.ou(n)})];case 1:return t.sent(),[4,zf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Oc(),new vf(e,t.rc,t.credentials,t.serializer,r)),n.Zc.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.cu._c(),[4,zf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.cu.stop()];case 3:t.sent(),0<n.Jc.length&&(Sr("RemoteStore","Stopping write stream with "+n.Jc.length+" pending writes"),n.Jc=[]),t.label=4;case 4:return[2]}})})})),n.cu}var Qf=function(t){this.key=t},Jf=function(t){this.key=t},$f=(Object.defineProperty(rl.prototype,"wu",{get:function(){return this.uu},enumerable:!1,configurable:!0}),rl.prototype.Eu=function(t,e){var s=this,u=e?e.Tu:new Wi,a=(e||this).du,c=(e||this).Qt,h=a,f=!1,l=lu(this.query)&&a.size===this.query.limit?a.last():null,p=pu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof ru?e:null)&&(Au(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Iu(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.fu(r,l)||p&&s.fu(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),lu(this.query)||pu(this.query))for(;h.size>this.query.limit;){var n=lu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{du:h,Tu:u,mu:f,Qt:c}},rl.prototype.Iu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},rl.prototype.Vr=function(t,e,n){var o=this,r=this.du;this.du=t.du,this.Qt=t.Qt;var i=t.Tu.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.fu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.Au(n);var s=e?this.Ru():[],n=0===this._u.size&&this.te?1:0,e=n!==this.lu;return this.lu=n,0!==i.length||e?{snapshot:new Xi(this.query,t.du,r,i,t.Qt,0==n,e,!1),Pu:s}:{Pu:s}},rl.prototype.Ks=function(t){return this.te&&"Offline"===t?(this.te=!1,this.Vr({du:this.du,Tu:new Wi,Qt:this.Qt,mu:!1},!1)):{Pu:[]}},rl.prototype.gu=function(t){return!this.uu.has(t)&&!!this.du.has(t)&&!this.du.get(t).Ye},rl.prototype.Au=function(t){var e=this;t&&(t.ee.forEach(function(t){return e.uu=e.uu.add(t)}),t.ne.forEach(function(t){}),t.se.forEach(function(t){return e.uu=e.uu.delete(t)}),this.te=t.te)},rl.prototype.Ru=function(){var e=this;if(!this.te)return[];var n=this._u;this._u=zi(),this.du.forEach(function(t){e.gu(t.key)&&(e._u=e._u.add(t.key))});var r=[];return n.forEach(function(t){e._u.has(t)||r.push(new Jf(t))}),this._u.forEach(function(t){n.has(t)||r.push(new Qf(t))}),r},rl.prototype.Vu=function(t){this.uu=t.Fh,this._u=zi();t=this.Eu(t.documents);return this.Vr(t,!0)},rl.prototype.yu=function(){return Xi.Gt(this.query,this.du,this.Qt,0===this.lu)},rl),Zf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},tl=function(t){this.key=t,this.pu=!1},el=(Object.defineProperty(nl.prototype,"Uu",{get:function(){return!0===this.qu},enumerable:!1,configurable:!0}),nl);function nl(t,e,n,r,i,o){this.Gc=t,this.bu=e,this.vu=n,this.Su=r,this.currentUser=i,this.Du=o,this.Cu={},this.Nu=new ei(_u,Eu),this.xu=new Map,this.Fu=[],this.ku=new xi(ui.D),this.Ou=new Map,this.Mu=new cf,this.$u={},this.Lu=new Map,this.Bu=Nh.da(),this.onlineState="Unknown",this.qu=void 0}function rl(t,e){this.query=t,this.uu=e,this.lu=null,this.te=!1,this._u=zi(),this.Qt=zi(),this.fu=Nu(t),this.du=new Ki(this.fu)}function il(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ku=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Eu(o)).mu?[4,$h(r.Gc,i.query,!1).then(function(t){t=t.documents;return i.view.Eu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Vr(e,r.Uu,n),[2,(ll(r,i.targetId,n.Pu),n.snapshot)]}})})}(i,t,e,n)},[4,$h(i.Gc,o,!0)];case 1:return n=t.sent(),r=new $f(o,n.Fh),e=r.Eu(n.documents),n=Qi.Zt(s,u&&"Offline"!==i.onlineState),n=r.Vr(e,i.Uu,n),ll(i,s,n.Pu),r=new Zf(o,s,r),[2,(i.Nu.set(o,r),i.xu.has(s)?i.xu.get(s).push(o):i.xu.set(s,[o]),n.snapshot)]}})})}function ol(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Yh(n.Gc,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.Ou.get(e);e&&(Pr(t.ee.size+t.ne.size+t.se.size<=1),0<t.ee.size?e.pu=!0:0<t.ne.size?Pr(e.pu):0<t.se.size&&(Pr(e.pu),e.pu=!1))}),[4,dl(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,nf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function sl(t,n,e){var r,t=t;(t.Uu&&0===e||!t.Uu&&1===e)&&(r=[],t.Nu.forEach(function(t,e){e=e.view.Ks(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Bs.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Ks(i)&&(o=!0)}),o&&Ra(t)}(t.vu,n),r.length&&t.Cu.yc(r),t.onlineState=n,t.Uu&&t.Su.ji(n))}function ul(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gc,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Sr.$o(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.Sr.Qo(e,t)}).next(function(){return i.Sr.zo(e)}).next(function(){return i.Nh.Or(e,n)})}))];case 2:return o=t.sent(),cl(n,u,a),al(n,u),n.Su.Oi(u,"rejected",a),[4,dl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,nf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function al(t,e){(t.Lu.get(e)||[]).forEach(function(t){t.resolve()}),t.Lu.delete(e)}function cl(t,e,n){var r=t,i=r.$u[r.currentUser.ti()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$u[r.currentUser.ti()]=i)}function hl(e,t,n){void 0===n&&(n=null),e.Su.Bi(t);for(var r=0,i=e.xu.get(t);r<i.length;r++){var o=i[r];e.Nu.delete(o),n&&e.Cu.Qu(o,n)}e.xu.delete(t),e.Uu&&e.Mu.Kh(t).forEach(function(t){e.Mu.Ho(t)||fl(e,t)})}function fl(t,e){var n=t.ku.get(e);null!==n&&(Rf(t.bu,n),t.ku=t.ku.remove(e),t.Ou.delete(n),pl(t))}function ll(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Qf?(t.Mu.Da(o.key,e),function(t,e){e=e.key;t.ku.get(e)||(Sr("SyncEngine","New document in limbo: "+e),t.Fu.push(e),pl(t))}(t,o)):o instanceof Jf?(Sr("SyncEngine","Document no longer in limbo: "+o.key),t.Mu.Na(o.key,e),t.Mu.Ho(o.key)||fl(t,o.key)):kr()}}function pl(t){for(;0<t.Fu.length&&t.ku.size<t.Du;){var e=t.Fu.shift(),n=t.Bu.next();t.Ou.set(n,new tl(e)),t.ku=t.ku.ot(e,n),Lf(t.bu,new Ai(mu(fu(e.path)),n,2,ja.ai))}}function dl(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Nu.P()?[3,3]:(n.Nu.forEach(function(t,e){o.push(n.Ku(e,s,u).then(function(t){t&&(n.Uu&&n.Su.Ki(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ec.zr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Cu.yc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return sa.forEach(c,function(e){return sa.forEach(e.jr,function(t){return r.persistence.No.Da(n,e.targetId,t)}).next(function(){return sa.forEach(e.Gr,function(t){return r.persistence.No.Na(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ya(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.bh.get(o),u=s.nt,u=s.rt(u),r.bh=r.bh.ot(o,u));return[2]}})})}(n.Gc,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function yl(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.ti()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Sr,m=e.Nh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Sr.Uo(v).next(function(t){return g=t,n=e.persistence.Th(o),m=new tc(e.Ch,n,e.persistence.Ah()),n.Uo(v)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Or(v,r).next(function(t){return{Wu:t,ju:e,Gu:n}})})})];case 1:return r=t.sent(),[2,(e.Sr=n,e.Nh=m,e.ph.xh(e.Nh),r)]}})})}(n.Gc,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Lu.forEach(function(t){t.forEach(function(t){t.reject(new _r(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Lu.clear(),n.Su.Wi(o,r.ju,r.Gu),[4,dl(n,r.Wu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function vl(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Gc,n=a,i=(r=e).Sr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Lo(e,n).next(function(t){return t?r.Nh.Or(e,t):sa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,zf(o.bu)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(cl(o,a,h||null),al(o,a),o.Gc.Sr.jo(a)):kr(),t.label=4;case 4:return[4,dl(o,s)];case 5:return t.sent(),[3,7];case 6:Sr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function gl(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return bl(r=h),Il(r),!0!==f||!0===r.qu?[3,3]:(e=r.Su.Ci(),[4,ml(r,e.L())]);case 1:return i=t.sent(),r.qu=!0,[4,Wf(r.bu,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Lf(r.bu,u);return[3,7];case 3:return!1!==f||!1===r.qu?[3,7]:(a=[],c=Promise.resolve(),r.xu.forEach(function(t,e){r.Su.qi(e)?a.push(e):c=c.then(function(){return hl(r,e),Jh(r.Gc,e,!0)}),Rf(r.bu,e)}),[4,c]);case 4:return t.sent(),[4,ml(r,a)];case 5:return t.sent(),(n=r).Ou.forEach(function(t,e){Rf(n.bu,e)}),n.Mu.Qh(),n.Ou=new Map,n.ku=new xi(ui.D),r.qu=!1,[4,Wf(r.bu,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function ml(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xu.get(s))&&0!==a.length?[4,Qh(e.Gc,mu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Nu.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,$h((e=r).Gc,i.query,!0)];case 1:return n=t.sent(),n=i.view.Vu(n),[2,(e.Uu&&ll(e,i.targetId,n.Pu),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Zh(e.Gc,s)];case 8:return l=t.sent(),[4,Qh(e.Gc,l)];case 9:return u=t.sent(),[4,il(e,wl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Cu.yc(r),n)]}})})}function wl(t){return hu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function bl(t){return t.bu.Hc.ru=ol.bind(null,t),t.bu.Hc.qe=function(t,e){var n=t;if((t=n.Ou.get(e))&&t.pu)return zi().add(t.key);var r=zi();if(!(e=n.xu.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Nu.get(s),r=r.Ot(s.view.wu);return r}.bind(null,t),t.bu.Hc.iu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Su.Ki(s,"rejected",u),i=e.Ou.get(s),(n=i&&i.key)?(r=(r=new xi(ui.D)).ot(n,new iu(n,ri.min())),i=zi().add(n),i=new Yi(ri.min(),new Map,new Ci(Vr),r,i),[4,ol(e,i)]):[3,2];case 1:return t.sent(),e.ku=e.ku.remove(n),e.Ou.delete(s),pl(e),[3,4];case 2:return[4,Jh(e.Gc,s,!1).then(function(){return hl(e,s,u)}).catch(nf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Cu.yc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Bs.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Ls=s}}r&&Ra(n)}.bind(null,t.vu),t.Cu.Qu=function(t,e,n){var r=t;if(t=r.Bs.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Bs.delete(e)}.bind(null,t.vu),t}function Il(t){return t.bu.Hc.ou=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Wh(e.Gc,o)];case 2:return r=t.sent(),cl(e,n,null),al(e,n),e.Su.Oi(n,"acknowledged"),[4,dl(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,nf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.bu.Hc.au=ul.bind(null,t),t}var El,_l,Tl,Al=(Ql.prototype.xh=function(t){this.zu=t},Ql.prototype.Lr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.on.length||1===r.on.length&&r.on[0].field.W())||i.isEqual(ri.min())?this.Hu(e,r):this.zu.Or(e,o).next(function(t){var n=s.Ju(r,t);return(lu(r)||pu(r))&&s.mu(r.an,n,o,i)?s.Hu(e,r):(Nr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Tu(r)),s.zu.Lr(e,r,i).next(function(e){return n.forEach(function(t){e=e.ot(t.key,t)}),e}))})},Ql.prototype.Ju=function(n,t){var r=new Ci(Nu(n));return t.forEach(function(t,e){e instanceof ru&&Au(n,e)&&(r=r.add(e))}),r},Ql.prototype.mu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.h(r))},Ql.prototype.Hu=function(t,e){return Nr()<=l.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",Tu(e)),this.zu.Lr(t,e,ri.min())},Ql),Nl=(Yl.prototype.ko=function(t){return sa.resolve(0===this.Sr.length)},Yl.prototype.Oo=function(t,e,n,r){var i=this.Yu;this.Yu++,0<this.Sr.length&&this.Sr[this.Sr.length-1];n=new Ja(i,e,n,r);this.Sr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Xu=this.Xu.add(new hf(u.key,i)),this.Dr.Mo(t,u.key.path.F())}return sa.resolve(n)},Yl.prototype.$o=function(t,e){return sa.resolve(this.Zu(e))},Yl.prototype.Bo=function(t,e){e+=1,e=this.tl(e),e=e<0?0:e;return sa.resolve(this.Sr.length>e?this.Sr[e]:null)},Yl.prototype.qo=function(){return sa.resolve(0===this.Sr.length?-1:this.Yu-1)},Yl.prototype.Uo=function(t){return sa.resolve(this.Sr.slice())},Yl.prototype.Nr=function(t,e){var n=this,r=new hf(e,0),e=new hf(e,Number.POSITIVE_INFINITY),i=[];return this.Xu.xt([r,e],function(t){t=n.Zu(t.jh);i.push(t)}),sa.resolve(i)},Yl.prototype.$r=function(t,e){var n=this,r=new Ci(Vr);return e.forEach(function(t){var e=new hf(t,0),t=new hf(t,Number.POSITIVE_INFINITY);n.Xu.xt([e,t],function(t){r=r.add(t.jh)})}),sa.resolve(this.el(r))},Yl.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,e=n;ui.X(e)||(e=e.child(""));var e=new hf(new ui(e),0),i=new Ci(Vr);return this.Xu.Ft(function(t){var e=t.key.path;return!!n.M(e)&&(e.length===r&&(i=i.add(t.jh)),!0)},e),sa.resolve(this.el(i))},Yl.prototype.el=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Zu(t);null!==t&&n.push(t)}),n},Yl.prototype.Qo=function(n,r){var i=this;Pr(0===this.nl(r.batchId,"removed")),this.Sr.shift();var o=this.Xu;return sa.forEach(r.mutations,function(t){var e=new hf(t.key,r.batchId);return o=o.delete(e),i.No.Go(n,t.key)}).next(function(){i.Xu=o})},Yl.prototype.jo=function(t){},Yl.prototype.Ho=function(t,e){var n=new hf(e,0),n=this.Xu.kt(n);return sa.resolve(e.isEqual(n&&n.key))},Yl.prototype.zo=function(t){return this.Sr.length,sa.resolve()},Yl.prototype.nl=function(t,e){return this.tl(t)},Yl.prototype.tl=function(t){return 0===this.Sr.length?0:t-this.Sr[0].batchId},Yl.prototype.Zu=function(t){t=this.tl(t);return t<0||t>=this.Sr.length?null:this.Sr[t]},Yl),Sl=(Xl.prototype.Ir=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.sl(e);return this.docs=this.docs.ot(r,{ta:e,size:i,readTime:n}),this.size+=i-o,this.Dr.Mo(t,r.path.F())},Xl.prototype.Ar=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Xl.prototype.Rr=function(t,e){e=this.docs.get(e);return sa.resolve(e?e.ta:null)},Xl.prototype.getEntries=function(t,e){var n=this,r=Ui;return e.forEach(function(t){var e=n.docs.get(t);r=r.ot(t,e?e.ta:null)}),sa.resolve(r)},Xl.prototype.Lr=function(t,e,n){for(var r=Fi,i=new ui(e.path.child("")),o=this.docs.ft(i);o.At();){var s=o.It(),u=s.key,a=s.value,s=a.ta,a=a.readTime;if(!e.path.M(u.path))break;a.h(n)<=0||s instanceof ru&&Au(e,s)&&(r=r.ot(s.key,s))}return sa.resolve(r)},Xl.prototype.il=function(t,e){return sa.forEach(this.docs,function(t){return e(t)})},Xl.prototype.ra=function(t){return new Dl(this)},Xl.prototype.aa=function(t){return sa.resolve(this.size)},Xl),Dl=(n(Wl,Tl=h),Wl.prototype.Vr=function(n){var r=this,i=[];return this.wr.forEach(function(t,e){e?i.push(r.ha.Ir(n,e,r.readTime)):r.ha.Ar(t)}),sa.kn(i)},Wl.prototype.Pr=function(t,e){return this.ha.Rr(t,e)},Wl.prototype.gr=function(t,e){return this.ha.getEntries(t,e)},Wl),xl=(Kl.prototype.Ce=function(t,n){return this.rl.forEach(function(t,e){return n(e)}),sa.resolve()},Kl.prototype.Ia=function(t){return sa.resolve(this.lastRemoteSnapshotVersion)},Kl.prototype.ma=function(t){return sa.resolve(this.ol)},Kl.prototype.wa=function(t){return this.highestTargetId=this.hl.next(),sa.resolve(this.highestTargetId)},Kl.prototype.Aa=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ol&&(this.ol=e),sa.resolve()},Kl.prototype.Pa=function(t){this.rl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Nh(e),this.highestTargetId=e),t.sequenceNumber>this.ol&&(this.ol=t.sequenceNumber)},Kl.prototype.Ra=function(t,e){return this.Pa(e),this.targetCount+=1,sa.resolve()},Kl.prototype.Va=function(t,e){return this.Pa(e),sa.resolve()},Kl.prototype.ya=function(t,e){return this.rl.delete(e.target),this.al.Kh(e.targetId),--this.targetCount,sa.resolve()},Kl.prototype.po=function(n,r,i){var o=this,s=0,u=[];return this.rl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.rl.delete(t),u.push(o.pa(n,e.targetId)),s++)}),sa.kn(u).next(function(){return s})},Kl.prototype.ba=function(t){return sa.resolve(this.targetCount)},Kl.prototype.va=function(t,e){e=this.rl.get(e)||null;return sa.resolve(e)},Kl.prototype.Sa=function(t,e,n){return this.al.Bh(e,n),sa.resolve()},Kl.prototype.Ca=function(e,t,n){this.al.Uh(t,n);var r=this.persistence.No,i=[];return r&&t.forEach(function(t){i.push(r.Go(e,t))}),sa.kn(i)},Kl.prototype.pa=function(t,e){return this.al.Kh(e),sa.resolve()},Kl.prototype.xa=function(t,e){e=this.al.Wh(e);return sa.resolve(e)},Kl.prototype.Ho=function(t,e){return sa.resolve(this.al.Ho(e))},Kl),Ol=(Hl.prototype.start=function(){return Promise.resolve()},Hl.prototype.Di=function(){return this.$a=!1,Promise.resolve()},Object.defineProperty(Hl.prototype,"Ii",{get:function(){return this.$a},enumerable:!1,configurable:!0}),Hl.prototype.Za=function(){},Hl.prototype.th=function(){},Hl.prototype.Ah=function(){return this.Dr},Hl.prototype.Th=function(t){var e=this.cl[t.ti()];return e||(e=new Nl(this.Dr,this.No),this.cl[t.ti()]=e),e},Hl.prototype.Ih=function(){return this.ja},Hl.prototype.mh=function(){return this.vr},Hl.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new kl(this.Ma.next());return this.No.ll(),n(i).next(function(t){return r.No._l(i).next(function(){return t})}).xn().then(function(t){return i.br(),t})},Hl.prototype.fl=function(e,n){return sa.On(Object.values(this.cl).map(function(t){return function(){return t.Ho(e,n)}}))},Hl),kl=(n(zl,_l=Ie),zl),Pl=(Bl.El=function(t){return new Bl(t)},Object.defineProperty(Bl.prototype,"Tl",{get:function(){if(this.wl)return this.wl;throw kr()},enumerable:!1,configurable:!0}),Bl.prototype.Da=function(t,e,n){return this.dl.Da(n,e),this.Tl.delete(n.toString()),sa.resolve()},Bl.prototype.Na=function(t,e,n){return this.dl.Na(n,e),this.Tl.add(n.toString()),sa.resolve()},Bl.prototype.Go=function(t,e){return this.Tl.add(e.toString()),sa.resolve()},Bl.prototype.removeTarget=function(t,e){var n=this;this.dl.Kh(e.targetId).forEach(function(t){return n.Tl.add(t.toString())});var r=this.persistence.Ih();return r.xa(t,e.targetId).next(function(t){t.forEach(function(t){return n.Tl.add(t.toString())})}).next(function(){return r.ya(t,e)})},Bl.prototype.ll=function(){this.wl=new Set},Bl.prototype._l=function(n){var r=this,i=this.persistence.mh().ra();return sa.forEach(this.Tl,function(t){var e=ui.H(t);return r.Il(n,e).next(function(t){t||i.Ar(e)})}).next(function(){return r.wl=null,i.apply(n)})},Bl.prototype.yh=function(t,e){var n=this;return this.Il(t,e).next(function(t){t?n.Tl.delete(e.toString()):n.Tl.add(e.toString())})},Bl.prototype.ul=function(t){return 0},Bl.prototype.Il=function(t,e){var n=this;return sa.On([function(){return sa.resolve(n.dl.Ho(e))},function(){return n.persistence.Ih().Ho(t,e)},function(){return n.persistence.fl(t,e)}])},Bl),Ll=(Gl.prototype.gc=function(t){this.Rl=t},Gl.prototype.Ic=function(t){this.Pl=t},Gl.prototype.onMessage=function(t){this.gl=t},Gl.prototype.close=function(){this.Al()},Gl.prototype.send=function(t){this.ml(t)},Gl.prototype.Vl=function(){this.Rl()},Gl.prototype.yl=function(t){this.Pl(t)},Gl.prototype.pl=function(t){this.gl(t)},Gl),Rl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Vl=(Fl.prototype.Mc=function(e,t,n,r){var i=this.Dl(e,t);Sr("RestConnection","Sending: ",i,n);t={};return this.Cl(t,r),this.Nl(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Fl.prototype.$c=function(t,e,n,r){return this.Mc(t,e,n,r)},Fl.prototype.Cl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.0.0",t["Content-Type"]="text/plain",e)for(var n in e.Gh)e.Gh.hasOwnProperty(n)&&(t[n]=e.Gh[n])},Fl.prototype.Dl=function(t,e){t=Rl[t];return this.vl+"/v1/"+e+":"+t},n(ql,El=Fl),ql.prototype.Nl=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new _r(Er.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new _r(e,t.message))):r(new _r(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new _r(Er.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},ql.prototype.Vc=function(t,e){var n,r=[this.vl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new hr,t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this._.projectId+"/databases/"+this._.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.T};this.Cl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Sr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Ll({ml:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Al:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(gr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.yl())}),t(gr.EventType.ERROR,function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),a.yl(new _r(Er.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ti[r];if(void 0!==t)return Di(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.yl(new _r(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.pl(e)))}),setTimeout(function(){a.Vl()},0),a},ql),Cl=(jl.prototype.eu=function(t){this.Ml.push(t)},jl.prototype.Di=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.kl)},jl.prototype.$l=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.kl)},jl.prototype.Fl=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(0)},jl.prototype.Ol=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ml;t<e.length;t++)(0,e[t])(1)},jl.Ln=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jl),Ml=(Ul.prototype.eu=function(t){},Ul.prototype.Di=function(){},Ul);function Ul(){}function jl(){var t=this;this.xl=function(){return t.Fl()},this.kl=function(){return t.Ol()},this.Ml=[],this.$l()}function ql(t){var e=this;return(e=El.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.T=t.T,e}function Fl(t){this.bl=t,this._=t._;var e=t.ssl?"https":"http";this.vl=e+"://"+t.host,this.Sl="projects/"+this._.projectId+"/databases/"+this._.database+"/documents"}function Gl(t){this.ml=t.ml,this.Al=t.Al}function Bl(t){this.persistence=t,this.dl=new cf,this.wl=null}function zl(t){var e=this;return(e=_l.call(this)||this).Fa=t,e}function Hl(t){var e=this;this.cl={},this.Ma=new ja(0),this.$a=!1,this.$a=!0,this.No=t(this),this.ja=new xl(this),this.Dr=new th,this.vr=(t=this.Dr,new Sl(t,function(t){return e.No.ul(t)}))}function Kl(t){this.persistence=t,this.rl=new ei(bi,Ii),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.ol=0,this.al=new cf,this.targetCount=0,this.hl=Nh.fa()}function Wl(t){var e=this;return(e=Tl.call(this)||this).ha=t,e}function Xl(t,e){this.Dr=t,this.sl=e,this.docs=new xi(ui.D),this.size=0}function Yl(t,e){this.Dr=t,this.No=e,this.Sr=[],this.Yu=1,this.Xu=new Ci(hf.Mh)}function Ql(){}function Jl(t){return new Po(t,!0)}var $l,Zl,tp=(cp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Su=this.Ll(e),this.persistence=this.Bl(e),[4,this.persistence.start()];case 1:return t.sent(),this.ql=this.Ul(e),this.Gc=this.Kl(e),[2]}})})},cp.prototype.Ul=function(t){return null},cp.prototype.Kl=function(t){return e=this.persistence,n=new Al,t=t.Ql,new Hh(e,n,t);var e,n},cp.prototype.Bl=function(t){return new Ol(Pl.El)},cp.prototype.Ll=function(t){return new Qa},cp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ql&&this.ql.stop(),[4,this.Su.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},cp),ep=(n(ap,Zl=tp),ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Zl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,ef(this.Gc)];case 2:return t.sent(),[4,this.Wl.initialize(this,e)];case 3:return t.sent(),[4,Il(this.Wl.fi)];case 4:return t.sent(),[4,zf(this.Wl.bu)];case 5:return t.sent(),[2]}})})},ap.prototype.Ul=function(t){var e=this.persistence.No.wo;return new Ic(e,t.hs)},ap.prototype.Bl=function(t){var e=zh(t.bl._,t.bl.persistenceKey),n=void 0!==this.cacheSizeBytes?mc.ao(this.cacheSizeBytes):mc.fo,r=Jl(t.bl._);return new Ch(this.synchronizeTabs,e,t.clientId,n,t.hs,_a(),Ta(),r,this.Su,!!this.forceOwnership)},ap.prototype.Ll=function(t){return new Qa},ap),np=(n(up,$l=ep),up.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,$l.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Wl.fi,this.Su instanceof Ya?(this.Su.fi={er:vl.bind(null,e),nr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).qu?(Sr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.xu.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,tf(e.Gc)];case 3:return n=t.sent(),r=Yi.Xt(o,"current"===s),[4,dl(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Jh(e.Gc,o,!0)];case 6:return t.sent(),hl(e,o,u),[3,8];case 7:kr(),t.label=8;case 8:return[2]}})})}.bind(null,e),sr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=bl(c)).qu)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.xu.has(r)?(Sr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Zh(n.Gc,r)]):[3,6];case 2:return i=t.sent(),[4,Qh(n.Gc,i)];case 3:return o=t.sent(),[4,il(n,wl(i),o.targetId,!1)];case 4:t.sent(),Lf(n.bu,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.xu.has(e)?[4,Jh(n.Gc,e,!1).then(function(){Rf(n.bu,e),hl(n,e)}).catch(nf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.Gc.persistence.pi()}.bind(null,e)},[4,this.Su.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Xa(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,gl(this.Wl.fi,e)];case 1:return t.sent(),this.ql&&(e&&!this.ql.Ii?this.ql.start(this.Gc):e||this.ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},up.prototype.Ll=function(t){var e=_a();if(!Ya.Ln(e))throw new _r(Er.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=zh(t.bl._,t.bl.persistenceKey);return new Ya(e,t.hs,n,t.clientId,t.Ql)},up),rp=(sp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Gc?[3,2]:(this.Gc=n.Gc,this.Su=n.Su,this.zc=this.jl(r),this.bu=this.Gl(r),this.vu=this.zl(r),this.fi=this.Hl(r,!n.synchronizeTabs),this.Su.di=function(t){return sl(e.fi,t,1)},this.bu.Hc.Jl=yl.bind(null,this.fi),[4,Wf(this.bu,this.fi.Uu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},sp.prototype.zl=function(t){return new ka},sp.prototype.jl=function(t){var e=Jl(t.bl._),n=(n=t.bl,new Vl(n));return t=t.credentials,new gf(t,n,e)},sp.prototype.Gl=function(t){var e=this,n=this.Gc,r=this.zc,i=t.hs,o=function(t){return sl(e.fi,t,0)},t=new(Cl.Ln()?Cl:Ml);return new of(n,r,i,o,t)},sp.prototype.Hl=function(t,e){return function(t,e,n,r,i,o,s){o=new el(t,e,n,r,i,o);return s&&(o.qu=!0),o}(this.Gc,this.bu,this.vu,this.Su,t.Ql,t.Du,e)},sp.prototype.terminate=function(){return Pf(this.bu)},sp),ip=(op.prototype.next=function(t){this.observer.next&&this.Yl(this.observer.next,t)},op.prototype.error=function(t){this.observer.error?this.Yl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},op.prototype.Xl=function(){this.muted=!0},op.prototype.Yl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},op);function op(t){this.observer=t,this.muted=!1}function sp(){}function up(t,e){var n=this;return(n=$l.call(this,t,e,!1)||this).Wl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ap(t,e,n){var r=this;return(r=Zl.call(this)||this).Wl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function cp(){this.synchronizeTabs=!1}function hp(t,e,n){if(!n)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function fp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function lp(t,e,n,r){if(!0===e&&!0===r)throw new _r(Er.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function pp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function dp(t,e){if(e<=0)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var yp,vp,gp=function(t){for(var e=0;e<t.length;++e)if(0===t[e].length)throw new _r(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new si(t)},mp=(n(_p,vp=gp),_p.documentId=function(){return new _p(si.j().B())},_p.prototype.isEqual=function(t){return t instanceof _p&&this.Zl.isEqual(t.Zl)},_p),wp=new RegExp("[~\\*/\\[\\]]"),bp=function(t){this.t_=t},Ip=(n(Ep,yp=bp),Ep.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Ep.prototype.isEqual=function(t){return t instanceof Ep},Ep);function Ep(){return null!==yp&&yp.apply(this,arguments)||this}function _p(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return vp.call(this,t)||this}function Tp(t,e,n){return new Wp({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e._,e.serializer,e.ignoreUndefinedProperties)}var Ap,Np,Sp,Dp,xp=(n(Hp,Dp=bp),Hp.prototype.e_=function(t){return new _s(t.path,new as)},Hp.prototype.isEqual=function(t){return t instanceof Hp},Hp),Op=(n(zp,Sp=bp),zp.prototype.e_=function(t){var e=Tp(this,t,!0),n=this.o_.map(function(t){return ed(t,e)}),n=new cs(n);return new _s(t.path,n)},zp.prototype.isEqual=function(t){return this===t},zp),kp=(n(Bp,Np=bp),Bp.prototype.e_=function(t){var e=Tp(this,t,!0),n=this.o_.map(function(t){return ed(t,e)}),n=new ds(n);return new _s(t.path,n)},Bp.prototype.isEqual=function(t){return this===t},Bp),Pp=(n(Gp,Ap=bp),Gp.prototype.e_=function(t){var e=new ms(t.serializer,Vo(t.serializer,this.a_));return new _s(t.path,e)},Gp.prototype.isEqual=function(t){return this===t},Gp),Lp=(Object.defineProperty(Fp.prototype,"latitude",{get:function(){return this.h_},enumerable:!1,configurable:!0}),Object.defineProperty(Fp.prototype,"longitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),Fp.prototype.isEqual=function(t){return this.h_===t.h_&&this.c_===t.c_},Fp.prototype.toJSON=function(){return{latitude:this.h_,longitude:this.c_}},Fp.prototype.g=function(t){return Vr(this.h_,t.h_)||Vr(this.c_,t.c_)},Fp),Rp=function(t){this.u_=t},Vp=/^__.*__$/,Cp=function(t,e,n){this.l_=t,this.__=e,this.f_=n},Mp=(qp.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new Cs(t,this.data,this.Qe,e)):n.push(new Vs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Fs(t,this.fieldTransforms)),n},qp),Up=(jp.prototype.d_=function(t,e){e=[new Cs(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new Fs(t,this.fieldTransforms)),e},jp);function jp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function qp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Fp(t,e){if(!isFinite(t)||t<-90||90<t)throw new _r(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.h_=t,this.c_=e}function Gp(t,e){var n=this;return(n=Ap.call(this,t)||this).a_=e,n}function Bp(t,e){var n=this;return(n=Np.call(this,t)||this).o_=e,n}function zp(t,e){var n=this;return(n=Sp.call(this,t)||this).o_=e,n}function Hp(){return null!==Dp&&Dp.apply(this,arguments)||this}function Kp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var Wp=(Object.defineProperty(Qp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Qp.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),Qp.prototype.E_=function(t){return new Qp(Object.assign(Object.assign({},this.settings),t),this._,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Qp.prototype.T_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.E_({path:e,r_:!1});return e.I_(t),e},Qp.prototype.m_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.E_({path:t,r_:!1});return t.w_(),t},Qp.prototype.A_=function(t){return this.E_({path:void 0,r_:!0})},Qp.prototype.s_=function(t){return ud(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},Qp.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.M(t)})||void 0!==this.fieldTransforms.find(function(t){return e.M(t.field)})},Qp.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.I_(this.path.get(t))},Qp.prototype.I_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(Kp(this.n_)&&Vp.test(t))throw this.s_('Document fields cannot begin and end with "__"')},Qp),Xp=(Yp.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new Wp({n_:t,methodName:e,i_:n,path:si.U(),r_:!1,R_:r},this._,this.serializer,this.ignoreUndefinedProperties)},Yp);function Yp(t,e,n){this._=t,this.ignoreUndefinedProperties=e,this.serializer=n||Jl(t)}function Qp(t,e,n,r,i,o){this.settings=t,this._=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Jp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);id("Data must be an object, but it was:",s,r);var u,a,r=nd(r,s);if(o.merge)u=new Es(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof gp)p=l.Zl;else{if("string"!=typeof l)throw kr();p=sd(e,l,n)}if(!s.contains(p))throw new _r(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ad(c,p)||c.push(p)}u=new Es(c),a=s.fieldTransforms.filter(function(t){return u.Je(t.field)})}else u=null,a=s.fieldTransforms;return new Mp(new Xs(r),u,a)}function $p(t,r,i,e){var o=t.P_(1,r,i);id("Data must be an object, but it was:",o,e);var s=[],u=new Ys;Jr(e,function(t,e){var n=sd(r,t,i),t=o.m_(n);e instanceof Ip||e instanceof Rp&&e.u_ instanceof Ip?s.push(n):null!=(t=ed(e,t))&&(s.push(n),u.set(n,t))});e=new Es(s);return new Up(u.Xe(),e,o.fieldTransforms)}function Zp(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[od(e,r,n)],a=[i];if(o.length%2!=0)throw new _r(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(od(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Ys,y=u.length-1;0<=y;--y){ad(p,u[y])||(h=u[y],f=a[y],l=s.m_(h),f instanceof Ip||f instanceof Rp&&f.u_ instanceof Ip?p.push(h):null!=(l=ed(f,l))&&(p.push(h),d.set(h,l)))}i=new Es(p);return new Up(d.Xe(),i,s.fieldTransforms)}function td(t,e,n,r){return void 0===r&&(r=!1),ed(n,t.P_(r?4:3,e))}function ed(s,t){if(s instanceof Rp&&(s=s.u_),rd(s))return id("Unsupported field value:",t,s),nd(s,t);if(s instanceof bp)return function(t,e){if(!Kp(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");t=t.e_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.r_&&4!==t.n_)throw t.s_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=ed(i[r],t.A_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Vo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ni.fromDate(t);return{timestampValue:Co(e.serializer,n)}}if(t instanceof ni){var r=new ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Co(e.serializer,r)}}if(t instanceof Lp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qr)return{bytesValue:Mo(e.serializer,t.l)};if(t instanceof Cp){n=e._,r=t.l_;if(!r.isEqual(n))throw e.s_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:jo(t.l_||e._,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+pp(t))}(s,t)}function nd(t,n){var r={};return $r(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Jr(t,function(t,e){e=ed(e,n.T_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function rd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ni||t instanceof Lp||t instanceof qr||t instanceof Cp||t instanceof bp)}function id(t,e,n){if(!rd(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){n=pp(n);throw"an object"===n?e.s_(t+" a custom object"):e.s_(t+" "+n)}var r}function od(t,e,n){if(e instanceof gp)return e.Zl;if("string"==typeof e)return sd(t,e);throw ud("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function sd(t,e,n){try{return function(e){if(0<=e.search(wp))throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(mp.bind.apply(mp,i([void 0],e.split("."))))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw ud(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function ud(t,e,n,r,i){var o=r&&!r.P(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new _r(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function ad(t,e){return t.some(function(t){return t.isEqual(e)})}var cd=(dd.prototype.b_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),0<this.mutations.length)throw new _r(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Ho((n=s).serializer)+"/documents",r={documents:u.map(function(t){return Fo(n.serializer,t)})},[4,n.$c("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),t=Uo(e.found.updateTime),e=new Xs({mapValue:{fields:e.found.fields}});return new ru(n,t,e,{})}(e,t):"missing"in t?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);t=Go(t,e.missing),e=Uo(e.readTime);return new iu(t,e)}(e,t):kr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Pr(!!t),o.push(t)}),o)]}})})}(this.zc,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof iu||t instanceof ru?n.S_(t):kr()}),e)]}})})},dd.prototype.set=function(t,e){this.write(e.d_(t,this.Ge(t))),this.p_.add(t.toString())},dd.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.y_=t}this.p_.add(t.toString())},dd.prototype.delete=function(t){this.write([new Ks(t,this.Ge(t))]),this.p_.add(t.toString())},dd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),this.y_)throw this.y_;return e=this.g_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ui.H(e);n.mutations.push(new Ws(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=Ho((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Xo(e.serializer,t)})},[4,e.Mc("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.zc,this.mutations)];case 1:return t.sent(),this.V_=!0,[2]}})})},dd.prototype.S_=function(t){var e;if(t instanceof ru)e=t.version;else{if(!(t instanceof iu))throw kr();e=ri.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Er.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},dd.prototype.Ge=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?Ns.updateTime(e):Ns.ze()},dd.prototype.D_=function(t){var e=this.g_.get(t.toString());if(this.p_.has(t.toString())||!e)return Ns.exists(!0);if(e.isEqual(ri.min()))throw new _r(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ns.updateTime(e)},dd.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},dd.prototype.v_=function(){},dd),hd=(pd.prototype.run=function(){this.N_()},pd.prototype.N_=function(){var t=this;this.Vs.Pn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new cd(this.zc),(n=this.x_(e))&&n.then(function(t){r.hs.ws(function(){return e.commit().then(function(){r.ls.resolve(t)}).catch(function(t){r.F_(t)})})}).catch(function(t){r.F_(t)}),[2]})})})},pd.prototype.x_=function(t){try{var e=this.updateFunction(t);return!yi(e)&&e.catch&&e.then?e:(this.ls.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ls.reject(t),null}},pd.prototype.F_=function(t){var e=this;0<this.C_&&this.k_(t)?(--this.C_,this.hs.ws(function(){return e.N_(),Promise.resolve()})):this.ls.reject(t)},pd.prototype.k_=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Si(t)},pd),fd=(ld.prototype.start=function(t,e,n){var r=this;this.M_(),this.bl=t;var i=new ra,o=!1;return this.credentials.Jh(function(t){return o?void r.hs.Cs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).hs.Fs(),Sr("RemoteStore","RemoteStore received new credentials"),n=jf(e),e.Xc.add(3),[4,kf(e)];case 1:return t.sent(),n&&e.nu.set("Unknown"),[4,e.Hc.Jl(i)];case 2:return t.sent(),e.Xc.delete(3),[4,Of(e)];case 3:return t.sent(),[2]}})})}(r.bu,t)}):(o=!0,Sr("FirestoreClient","Initializing. user=",t.uid),r.L_(e,n,t,i).then(r.O_.resolve,r.O_.reject))}),this.hs.ws(function(){return r.O_.promise}),i.promise},ld.prototype.enableNetwork=function(){var e=this;return this.M_(),this.hs.enqueue(function(){return e.persistence.th(!0),(t=e.bu).Xc.delete(0),Of(t);var t})},ld.prototype.L_=function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={hs:this.hs,bl:this.bl,clientId:this.clientId,credentials:this.credentials,Ql:o,Du:100},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Su=r.Su,this.Gc=r.Gc,this.ql=r.ql,this.zc=i.zc,this.bu=i.bu,this.fi=i.fi,this.B_=i.vu,this.B_.Us=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=bl(s),(o=e.Nu.get(u))?(n=o.targetId,e.Su.$i(n),r=o.view.yu(),[3,4]):[3,1];case 1:return[4,Qh(e.Gc,mu(u))];case 2:return i=t.sent(),o=e.Su.$i(i.targetId),n=i.targetId,[4,il(e,u,n,"current"===o)];case 3:r=t.sent(),e.Uu&&Lf(e.bu,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.fi),this.B_.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Nu.get(o),1<(r=e.xu.get(n.targetId)).length?[2,(e.xu.set(n.targetId,r.filter(function(t){return!Eu(t,o)})),void e.Nu.delete(o))]:e.Uu?(e.Su.Bi(n.targetId),e.Su.xi(n.targetId)?[3,2]:[4,Jh(e.Gc,n.targetId,!1).then(function(){e.Su.Ui(n.targetId),Rf(e.bu,n.targetId),hl(e,n.targetId)}).catch(nf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return hl(e,n.targetId),[4,Jh(e.Gc,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.fi),this.persistence.Za(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),s.resolve(),[3,4];case 3:if(e=t.sent(),s.reject(e),!("FirebaseError"===e.name?e.code===Er.FAILED_PRECONDITION||e.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.L_(new tp,new rp,o,s))];case 4:return[2]}})})},ld.prototype.M_=function(){if(this.hs.ps)throw new _r(Er.FAILED_PRECONDITION,"The client has already been terminated.")},ld.prototype.disableNetwork=function(){var t=this;return this.M_(),this.hs.enqueue(function(){return t.persistence.th(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Xc.add(0),[4,kf(e)];case 1:return t.sent(),e.nu.set("Offline"),[2]}})})}(t.bu)})},ld.prototype.terminate=function(){var t=this;this.hs.Ds();var n=new ra;return this.hs.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.ql&&this.ql.stop(),[4,Pf(this.bu)];case 1:return t.sent(),[4,this.Su.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.Yh(),n.resolve(),[3,5];case 4:return e=t.sent(),e=xa(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},ld.prototype.waitForPendingWrites=function(){var t=this;this.M_();var e=new ra;return this.hs.ws(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:jf((n=o).bu)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Gc).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Sr.qo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Lu.get(r)||[]).push(s),n.Lu.set(r,i),[3,4]);case 3:return i=t.sent(),i=xa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.fi,e)}),e.promise},ld.prototype.listen=function(t,e,n){var r=this;this.M_();var i=new ip(n),o=new Va(t,i,e);return this.hs.ws(function(){return Pa(r.B_,o)}),function(){i.Xl(),r.hs.ws(function(){return La(r.B_,o)})}},ld.prototype.q_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ra,[2,(this.hs.ws(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Nh.Cr(t,e)}))];case 1:return(r=t.sent())instanceof ru?s.resolve(r):r instanceof iu?s.resolve(null):s.reject(new _r(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=xa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Gc,r,e)}),e.promise)]}})})},ld.prototype.U_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ra,[2,(this.hs.ws(function(){return n=a.B_,r=a.hs,i=c,o=h,s=e,t=new ip({next:function(t){r.ws(function(){return La(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new _r(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new _r(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Va(fu(i.path),t,{includeMetadataChanges:!0,Xs:!0}),Pa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},ld.prototype.K_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),e=new ra,[2,(this.hs.ws(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,$h(r,i,!0)];case 1:return n=t.sent(),e=new $f(i,n.Fh),n=e.Eu(n.documents),n=e.Vr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=xa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Gc,r,e)}),e.promise)]}})})},ld.prototype.Q_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.M_(),[4,this.O_.promise];case 1:return t.sent(),u=new ra,[2,(this.hs.ws(function(){return e=a.B_,n=a.hs,t=c,r=h,i=u,o=new ip({next:function(t){n.ws(function(){return La(e,s)}),t.fromCache&&"server"===r.source?i.reject(new _r(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Va(t,o,{includeMetadataChanges:!0,Xs:!0}),Pa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},ld.prototype.write=function(t){var e=this;this.M_();var n=new ra;return this.hs.ws(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Il(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Gc,a=p,h=i,f=ni.now(),o=a.reduce(function(t,e){return t.add(e.key)},zi()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Nh.Or(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof Fs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ru?t.field(i.field):void 0,o=os(i.transform,o||null);null!=o&&(e=(null==e?new Ys:e).set(i.field,o))}return e?e.Xe():null}(o):null);null!=o&&e.push(new Cs(i.key,o,function s(t){var u=[];return Jr(t.fields||{},function(t,e){var n=new si([t]);if(xo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Es(u)}(o.proto.mapValue),Ns.exists(!0)))}return h.Sr.Oo(u,f,e,a)})}).then(function(t){var e=t.lr(c);return{batchId:t.batchId,wr:e}}))];case 2:return s=t.sent(),u.Su.Fi(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$u[e.currentUser.ti()])||new xi(Vr)).ot(n,r),e.$u[e.currentUser.ti()]=i,[4,dl(u,s.wr)];case 3:return t.sent(),[4,zf(u.bu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=xa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e.fi,t,n)}),n.promise},ld.prototype._=function(){return this.bl._},ld.prototype.W_=function(t){var e=this;this.M_();var r=new ip(t);return this.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.B_,n=r,e.qs.add(n),void n.next())];var e,n})})}),function(){r.Xl(),e.hs.ws(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.B_.qs.delete(r)]})})})}},Object.defineProperty(ld.prototype,"j_",{get:function(){return this.hs.ps},enumerable:!1,configurable:!0}),ld.prototype.transaction=function(t){var e=this;this.M_();var n=new ra;return this.hs.ws(function(){return new hd(e.hs,e.zc,t,n).run(),Promise.resolve()}),n.promise},ld);function ld(t,e){this.credentials=t,this.hs=e,this.clientId=Lr.t(),this.O_=new ra}function pd(t,e,n,r){this.hs=t,this.zc=e,this.updateFunction=n,this.ls=r,this.C_=5,this.Vs=new oa(this.hs,"transaction_retry")}function dd(t){this.zc=t,this.g_=new Map,this.mutations=[],this.V_=!1,this.y_=null,this.p_=new Set}function yd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var vd,gd,md=(Fd.prototype.J_=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Eo(t.integerValue||t.doubleValue);case 3:return this.Y_(t.timestampValue);case 4:return this.X_(t);case 5:return t.stringValue;case 6:return this.H_(_o(t.bytesValue));case 7:return this.Z_(t.referenceValue);case 8:return this.tf(t.geoPointValue);case 9:return this.ef(t.arrayValue);case 10:return this.nf(t.mapValue);default:throw kr()}},Fd.prototype.nf=function(t){var n=this,r={};return Jr(t.fields||{},function(t,e){r[t]=n.J_(e)}),r},Fd.prototype.tf=function(t){return new Lp(Eo(t.latitude),Eo(t.longitude))},Fd.prototype.ef=function(t){var e=this;return(t.values||[]).map(function(t){return e.J_(t)})},Fd.prototype.X_=function(t){switch(this.G_){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return fo(e)?t(e):e}(t);return null==e?null:this.J_(e);case"estimate":return this.Y_(lo(t));default:return null}},Fd.prototype.Y_=function(t){t=Io(t);return new ni(t.seconds,t.nanos)},Fd.prototype.Z_=function(t){var e=ii.q(t);Pr(is(e));t=new Wr(e.get(1),e.get(3)),e=new ui(e.N(5));return t.isEqual(this._)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this._.projectId+"/"+this._.database+") instead."),this.z_(e)},Fd),wd=mc.uo,bd=(qd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},qd),Id="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Ed=(jd.prototype.enableIndexedDbPersistence=function(t,e){throw new _r(Er.FAILED_PRECONDITION,Id)},jd.prototype.enableMultiTabIndexedDbPersistence=function(t){throw new _r(Er.FAILED_PRECONDITION,Id)},jd.prototype.clearIndexedDbPersistence=function(t){throw new _r(Er.FAILED_PRECONDITION,Id)},jd),_d=(Ud.prototype.enableIndexedDbPersistence=function(t,e){var n=new rp,e=new ep(n,t.sf().cacheSizeBytes,e);return t.if(e,n)},Ud.prototype.enableMultiTabIndexedDbPersistence=function(t){var e=new rp,n=new np(e,t.sf().cacheSizeBytes);return t.if(n,e)},Ud.prototype.clearIndexedDbPersistence=function(n){var t=this,r=new ra;return n.rf.bs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return ua.Ln()?(e=n+"main",[4,ua.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(zh(n.l_,n.af))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise},Ud),Td=(Object.defineProperty(Md.prototype,"wf",{get:function(){return this.Ef||(this.Ef=new Xp(this.l_,this.df.ignoreUndefinedProperties)),this.Ef},enumerable:!1,configurable:!0}),Md.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge;t=new bd(t);if(this.lf&&!this.df.isEqual(t))throw new _r(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");void 0!==(this.df=t).credentials&&(this.ff=function(t){if(!t)return new ff;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new df(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new _r(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Md.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.df.host&&xr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},Md.prototype.enableNetwork=function(){return this.uf(),this.lf.enableNetwork()},Md.prototype.disableNetwork=function(){return this.uf(),this.lf.disableNetwork()},Md.prototype.enablePersistence=function(t){if(this.lf)throw new _r(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1,n=!1;return t&&lp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.hf.enableMultiTabIndexedDbPersistence(this):this.hf.enableIndexedDbPersistence(this,n)},Md.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){return v(this,function(t){if(void 0!==this.lf&&!this.lf.j_)throw new _r(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return[2,this.hf.clearIndexedDbPersistence(this)]})})},Md.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Md.prototype,"Tf",{get:function(){return this.uf(),this.lf.j_},enumerable:!1,configurable:!0}),Md.prototype.waitForPendingWrites=function(){return this.uf(),this.lf.waitForPendingWrites()},Md.prototype.onSnapshotsInSync=function(t){if(this.uf(),yd(t))return this.lf.W_(t);t={next:t};return this.lf.W_(t)},Md.prototype.uf=function(){return this.lf||this.if(new tp,new rp),this.lf},Md.prototype.If=function(){return new zr(this.l_,this.af,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling,this.df.experimentalAutoDetectLongPolling)},Md.prototype.if=function(t,e){var n=this.If();return this.lf=new fd(this.ff,this.rf),this.lf.start(n,t,e)},Md._f=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new _r(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Wr(t)},Object.defineProperty(Md.prototype,"app",{get:function(){if(!this.cf)throw new _r(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.cf},enumerable:!1,configurable:!0}),Md.prototype.collection=function(t){return hp("Firestore.collection","path",t),this.uf(),new Yd(ii.q(t),this,null)},Md.prototype.doc=function(t){return hp("Firestore.doc","path",t),this.uf(),Sd.mf(ii.q(t),this,null)},Md.prototype.collectionGroup=function(t){if(hp("Firestore.collectionGroup","collectionId",t),0<=t.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Wd((t=t,new su(ii.U(),t)),this,null)},Md.prototype.runTransaction=function(e){var n=this;return this.uf().transaction(function(t){return e(new Ad(n,t))})},Md.prototype.batch=function(){return this.uf(),new Nd(this)},Md.prototype.sf=function(){return this.df},Md),Ad=(Cd.prototype.get=function(t){var e=this,n=Zd(0,t,this.Af);return this.Rf.b_([n.__]).then(function(t){if(!t||1!==t.length)return kr();t=t[0];if(t instanceof iu)return new xd(e.Af,n.__,null,!1,!1,n.f_);if(t instanceof ru)return new xd(e.Af,n.__,t,!1,!1,n.f_);throw kr()})},Cd.prototype.set=function(t,e,n){t=Zd(0,t,this.Af);n=fp("Transaction.set",n);e=ty(t.f_,e,n),n=Jp(this.Af.wf,"Transaction.set",t.__,e,null!==t.f_,n);return this.Rf.set(t.__,n),this},Cd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof mp?(r=Zd(0,t,this.Af),Zp(this.Af.wf,"Transaction.update",r.__,e,n,i)):(r=Zd(0,t,this.Af),$p(this.Af.wf,"Transaction.update",r.__,e)),this.Rf.update(r.__,e),this},Cd.prototype.delete=function(t){t=Zd(0,t,this.Af);return this.Rf.delete(t.__),this},Cd),Nd=(Vd.prototype.set=function(t,e,n){this.Vf();t=Zd(0,t,this.Af);n=fp("WriteBatch.set",n);e=ty(t.f_,e,n),n=Jp(this.Af.wf,"WriteBatch.set",t.__,e,null!==t.f_,n);return this.Pf=this.Pf.concat(n.d_(t.__,Ns.ze())),this},Vd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.Vf(),e="string"==typeof e||e instanceof mp?(r=Zd(0,t,this.Af),Zp(this.Af.wf,"WriteBatch.update",r.__,e,n,i)):(r=Zd(0,t,this.Af),$p(this.Af.wf,"WriteBatch.update",r.__,e)),this.Pf=this.Pf.concat(e.d_(r.__,Ns.exists(!0))),this},Vd.prototype.delete=function(t){this.Vf();t=Zd(0,t,this.Af);return this.Pf=this.Pf.concat(new Ks(t.__,Ns.ze())),this},Vd.prototype.commit=function(){return this.Vf(),this.gf=!0,0<this.Pf.length?this.Af.uf().write(this.Pf):Promise.resolve()},Vd.prototype.Vf=function(){if(this.gf)throw new _r(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Vd),Sd=(n(Rd,gd=Cp),Rd.mf=function(t,e,n){if(t.length%2!=0)throw new _r(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.B()+" has "+t.length);return new Rd(new ui(t),e,n)},Object.defineProperty(Rd.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"parent",{get:function(){return new Yd(this.__.path.F(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Rd.prototype,"path",{get:function(){return this.__.path.B()},enumerable:!1,configurable:!0}),Rd.prototype.collection=function(t){if(hp("DocumentReference.collection","path",t),!t)throw new _r(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=ii.q(t);return new Yd(this.__.path.child(t),this.firestore,null)},Rd.prototype.isEqual=function(t){return t instanceof Rd&&this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},Rd.prototype.set=function(t,e){e=fp("DocumentReference.set",e);t=ty(this.f_,t,e),e=Jp(this.firestore.wf,"DocumentReference.set",this.__,t,null!==this.f_,e);return this.lf.write(e.d_(this.__,Ns.ze()))},Rd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof mp?Zp(this.firestore.wf,"DocumentReference.update",this.__,t,e,n):$p(this.firestore.wf,"DocumentReference.update",this.__,t),this.lf.write(t.d_(this.__,Ns.exists(!0)))},Rd.prototype.delete=function(){return this.lf.write([new Ks(this.__,Ns.ze())])},Rd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||yd(n[i])||(r=n[i],i++);var o={includeMetadataChanges:r.includeMetadataChanges};yd(n[i])&&(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s));var s={next:function(t){n[i]&&n[i](e.yf(t))},error:n[i+1],complete:n[i+2]};return this.lf.listen(fu(this.__.path),o,s)},Rd.prototype.get=function(t){var e=this,n=this.firestore.uf();return t&&"cache"===t.source?n.q_(this.__).then(function(t){return new xd(e.firestore,e.__,t,!0,t instanceof ru&&t.Ye,e.f_)}):n.U_(this.__,t).then(function(t){return e.yf(t)})},Rd.prototype.withConverter=function(t){return new Rd(this.__,this.firestore,t)},Rd.prototype.yf=function(t){var e=t.docs.get(this.__);return new xd(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},Rd),Dd=(Ld.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ld),xd=(Pd.prototype.data=function(t){var e=this;if(void 0===t&&(t={}),this.pf){if(this.f_){var n=new Od(this.Af,this.__,this.pf,this.bf,this.vf,null);return this.f_.fromFirestore(n,t)}return new md(this.Af.l_,t.serverTimestamps||"none",function(t){return new Sd(t,e.Af,null)},function(t){return new Kr(t)}).J_(this.pf.rn())}},Pd.prototype.get=function(t,e){var n=this;if(void 0===e&&(e={}),this.pf){t=this.pf.data().field(od("DocumentSnapshot.get",t,this.__));if(null!==t)return new md(this.Af.l_,e.serverTimestamps||"none",function(t){return new Sd(t,n.Af,n.f_)},function(t){return new Kr(t)}).J_(t)}},Object.defineProperty(Pd.prototype,"id",{get:function(){return this.__.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"ref",{get:function(){return new Sd(this.__,this.Af,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!1,configurable:!0}),Object.defineProperty(Pd.prototype,"metadata",{get:function(){return new Dd(this.vf,this.bf)},enumerable:!1,configurable:!0}),Pd.prototype.isEqual=function(t){return t instanceof Pd&&this.Af===t.Af&&this.bf===t.bf&&this.__.isEqual(t.__)&&(null===this.pf?null===t.pf:this.pf.isEqual(t.pf))&&this.f_===t.f_},Pd),Od=(n(kd,vd=xd),kd.prototype.data=function(t){return vd.prototype.data.call(this,t)},kd);function kd(){return null!==vd&&vd.apply(this,arguments)||this}function Pd(t,e,n,r,i,o){this.Af=t,this.__=e,this.pf=n,this.bf=r,this.vf=i,this.f_=o}function Ld(t,e){this.hasPendingWrites=t,this.fromCache=e}function Rd(t,e,n){var r=this;return(r=gd.call(this,e.l_,t,n)||this).__=t,r.firestore=e,r.f_=n,r.lf=r.firestore.uf(),r}function Vd(t){this.Af=t,this.Pf=[],this.gf=!1}function Cd(t,e){this.Af=t,this.Rf=e}function Md(t,e,n){var r=this;if(void 0===n&&(n=new Ed),this.hf=n,this.cf=null,this.rf=new Na,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uf(),[4,this.lf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){n=t;this.cf=n,this.l_=Md._f(n),this.af=n.name,this.ff=new lf(e)}else{t=t;if(!t.projectId)throw new _r(Er.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Wr(t.projectId,t.database),this.af="[DEFAULT]",this.ff=new ff}this.df=new bd({})}function Ud(){}function jd(){}function qd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=mc._o;else{if(t.cacheSizeBytes!==wd&&t.cacheSizeBytes<mc.lo)throw new _r(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+mc.lo);this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,lp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Fd(t,e,n,r){this._=t,this.G_=e,this.z_=n,this.H_=r}function Gd(t,e,n){if("string"==typeof n){if(""===n)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!vu(e)&&-1!==n.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(ii.q(n));if(!ui.X(e))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return To(t,new ui(e))}if(n instanceof Cp)return To(t,n.__);throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pp(n)+".")}function Bd(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function zd(t,e,n){if(!n.isEqual(e))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Hd(t){if(pu(t)&&0===t.on.length)throw new _r(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kd,Wd=($d.prototype.where=function(t,e,n){t=od("Query.where",t),e=function(t,e,n,r,i,o){if(r.W()){if("array-contains"===i||"array-contains-any"===i)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Bd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Gd(n,t,c))}h={arrayValue:{values:s}}}else h=Gd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Bd(o,i),h=td(e,"Query.where",o,"in"===i||"not-in"===i);var h=Du.create(r,i,h);return function(t,e){if(e.un()){var n=yu(t);if(null!==n&&!n.isEqual(e.field))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=du(t);null!==n&&zd(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new _r(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _r(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Sf,this.firestore.wf,this.firestore.l_,t,e,n);return new $d((n=this.Sf,e=n.filters.concat([e]),new su(n.path,n.collectionGroup,n.on.slice(),e,n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},$d.prototype.orderBy=function(t,e){if(void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=od("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");e=new na(e,n);return n=e,null!==du(t)||null!==(t=yu(t))&&zd(0,t,n.field),e}(this.Sf,t,n);return new $d((n=this.Sf,t=n.on.concat([t]),new su(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.an,n.startAt,n.endAt)),this.firestore,this.f_)},$d.prototype.limit=function(t){return dp("Query.limit",t),new $d(wu(this.Sf,t,"F"),this.firestore,this.f_)},$d.prototype.limitToLast=function(t){return dp("Query.limitToLast",t),new $d(wu(this.Sf,t,"L"),this.firestore,this.f_)},$d.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.startAt",t,e,!0);return new $d(bu(this.Sf,t),this.firestore,this.f_)},$d.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.startAfter",t,e,!1);return new $d(bu(this.Sf,t),this.firestore,this.f_)},$d.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.endBefore",t,e,!0);return new $d(Iu(this.Sf,t),this.firestore,this.f_)},$d.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.Df("Query.endAt",t,e,!1);return new $d(Iu(this.Sf,t),this.firestore,this.f_)},$d.prototype.isEqual=function(t){return t instanceof $d&&this.firestore===t.firestore&&Eu(this.Sf,t.Sf)&&this.f_===t.f_},$d.prototype.withConverter=function(t){return new $d(this.Sf,this.firestore,t)},$d.prototype.Df=function(c,t,e,n){if(t instanceof xd)return function(t,e,n,r){if(!n)throw new _r(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=gu(t);o<s.length;o++){var u=s[o];if(u.field.W())i.push(To(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new _r(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.B();throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Xu(i,r)}(this.Sf,this.firestore.l_,t.pf,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.on;if(i.length>s.length)throw new _r(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.W()){if("string"!=typeof c)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!vu(t)&&-1!==c.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.q(c));if(!ui.X(h))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ui(h);u.push(To(e,h))}else{c=td(n,r,c);u.push(c)}}return new Xu(u,o)}(this.Sf,this.firestore.l_,this.firestore.wf,c,e,n)},$d.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i={},o=0;"object"!=typeof n[o]||yd(n[o])||(i=n[o],o++),yd(n[o])&&(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s));var s={next:function(t){n[o]&&n[o](new Xd(e.firestore,e.Sf,t,e.f_))},error:n[o+1],complete:n[o+2]};return Hd(this.Sf),this.firestore.uf().listen(this.Sf,i,s)},$d.prototype.get=function(t){var e=this;Hd(this.Sf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.K_(this.Sf):n.Q_(this.Sf,t)).then(function(t){return new Xd(e.firestore,e.Sf,t,e.f_)})},$d),Xd=(Object.defineProperty(Jd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Jd.prototype,"empty",{get:function(){return this.Nf.docs.P()},enumerable:!1,configurable:!0}),Object.defineProperty(Jd.prototype,"size",{get:function(){return this.Nf.docs.size},enumerable:!1,configurable:!0}),Jd.prototype.forEach=function(e,n){var r=this;this.Nf.docs.forEach(function(t){e.call(n,r.kf(t,r.metadata.fromCache,r.Nf.Qt.has(t.key)))})},Object.defineProperty(Jd.prototype,"query",{get:function(){return new Wd(this.Cf,this.Af,this.f_)},enumerable:!1,configurable:!0}),Jd.prototype.docChanges=function(t){t=!(!t||!t.includeMetadataChanges);if(t&&this.Nf.jt)throw new _r(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Ff===t||(this.xf=function(i,e,o){if(i.Kt.P()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Kt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Nf,t,this.kf.bind(this)),this.Ff=t),this.xf},Jd.prototype.isEqual=function(t){return t instanceof Jd&&this.Af===t.Af&&Eu(this.Cf,t.Cf)&&this.Nf.isEqual(t.Nf)&&this.f_===t.f_},Jd.prototype.kf=function(t,e,n){return new Od(this.Af,t.key,t,e,n,this.f_)},Jd),Yd=(n(Qd,Kd=Wd),Object.defineProperty(Qd.prototype,"id",{get:function(){return this.Sf.path.O()},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"parent",{get:function(){var t=this.Sf.path.F();return t.P()?null:new Sd(new ui(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"path",{get:function(){return this.Sf.path.B()},enumerable:!1,configurable:!0}),Qd.prototype.doc=function(t){0===arguments.length&&(t=Lr.t()),hp("CollectionReference.doc","path",t);t=ii.q(t);return Sd.mf(this.Sf.path.child(t),this.firestore,this.f_)},Qd.prototype.add=function(t){var t=this.f_?this.f_.toFirestore(t):t,e=this.doc();return new Sd(e.__,this.firestore,null).set(t).then(function(){return e})},Qd.prototype.withConverter=function(t){return new Qd(this.Of,this.firestore,t)},Qd);function Qd(t,e,n){var r=this;if(((r=Kd.call(this,fu(t),e,n)||this).Of=t).length%2!=1)throw new _r(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.B()+" has "+t.length);return r}function Jd(t,e,n,r){this.Af=t,this.Cf=e,this.Nf=n,this.f_=r,this.xf=null,this.Ff=null,this.metadata=new Dd(n.hasPendingWrites,n.fromCache)}function $d(t,e,n){this.Sf=t,this.firestore=e,this.f_=n}function Zd(t,e,n){e=function(t,e){if(t instanceof e)return t;if(e.name===t.constructor.name)throw new _r(Er.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");t=pp(t);throw new _r(Er.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}(e,Sd);if(e.firestore!==n)throw new _r(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function ty(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ey,ny,Ie=(n(iy,ey=Rp),iy.serverTimestamp=function(){var t=new xp("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new iy(t)},iy.delete=function(){var t=new Ip("deleteField");return t.t_="FieldValue.delete",new iy(t)},iy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Op("arrayUnion",t)}.apply(void 0,t);return n.t_="FieldValue.arrayUnion",new iy(n)},iy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new kp("arrayRemove",t)}.apply(void 0,t);return n.t_="FieldValue.arrayRemove",new iy(n)},iy.increment=function(t){t=new Pp("increment",t);return t.t_="FieldValue.increment",new iy(t)},iy.prototype.isEqual=function(t){return this.u_.isEqual(t.u_)},iy),ry={Firestore:Td,GeoPoint:Lp,Timestamp:ni,Blob:Kr,Transaction:Ad,WriteBatch:Nd,DocumentReference:Sd,DocumentSnapshot:xd,Query:Wd,QueryDocumentSnapshot:Od,QuerySnapshot:Xd,CollectionReference:Yd,FieldPath:mp,FieldValue:Ie,setLogLevel:function(t){Tr.setLogLevel(t)},CACHE_SIZE_UNLIMITED:wd};function iy(){return null!==ey&&ey.apply(this,arguments)||this}(ny=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Td(e,t,new _d);var e},"PUBLIC").setServiceProps(Object.assign({},ry))),ny.registerVersion("@firebase/firestore","2.0.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map
